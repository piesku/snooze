<!DOCTYPE html><meta charset=utf8><meta name=viewport content="width=device-width, user-scalable=0"><meta name=apple-mobile-web-app-capable content=yes><meta name=theme-color content=#000><title>GoodLuck (opt)</title><style>body,html{margin:0;overflow:hidden}canvas,main{height:100vh;overflow:hidden;position:absolute;touch-action:none;user-select:none;width:100vw;word-break:break-word}[onclick]{cursor:pointer}</style><canvas id=scene></canvas><canvas id=billboard></canvas><main></main><script>(()=>{function t(t,n){let i=t.i.t();for(let e of n)e(t,i);return i}function n(...n){return(i,e)=>{16&i.i.o[e]||(i.i.o[e]|=16,i.i.l[e]={l:[]});let o=i.i.l[e].l;for(let e of n){let n=t(i,e);o.push(n)}}}function*i(t,n,e){if((t.o[n]&e)===e&&(yield n),16&t.o[n])for(let o of t.l[n].l)yield*i(t,o,e)}function e(t,n){if(16&t.o[n])for(let i of t.l[n].l)e(t,i);t.u(n)}function o(t,n,i){switch(n){case 0:document.fullscreenElement?document.exitFullscreen():document.body.requestFullscreen();break;case 1:{let[n]=i;e(t.i,n),t.h++;break}}}function r(t,n,i){let e=t.createProgram();return t.attachShader(e,l(t,35633,n)),t.attachShader(e,l(t,35632,i)),t.linkProgram(e),e}function l(t,n,i){let e=t.createShader(n);return t.shaderSource(e,i),t.compileShader(e),e}function s(t,n,i){return Math.max(t,Math.min(n,i))}function c(t,n,i,e){return t[0]=n,t[1]=i,t[2]=e,t}function a(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function f(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t[2]=n[2]+i[2],t}function u(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t}function h(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t}function d(t,n){let i=n[0],e=n[1],o=n[2],r=i*i+e*e+o*o;return r>0&&(r=1/Math.sqrt(r)),t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t}function v(t,n,i){let e=n[0],o=n[1],r=n[2],l=i[3]*e+i[7]*o+i[11]*r+i[15]||1;return t[0]=(i[0]*e+i[4]*o+i[8]*r+i[12])/l,t[1]=(i[1]*e+i[5]*o+i[9]*r+i[13])/l,t[2]=(i[2]*e+i[6]*o+i[10]*r+i[14])/l,t}function m(t,n,i){let e=n[0],o=n[1],r=n[2];return t[0]=i[0]*e+i[4]*o+i[8]*r,t[1]=i[1]*e+i[5]*o+i[9]*r,t[2]=i[2]*e+i[6]*o+i[10]*r,t}function _(t,n,i,e){let o=n[0],r=n[1],l=n[2];return t[0]=o+e*(i[0]-o),t[1]=r+e*(i[1]-r),t[2]=l+e*(i[2]-l),t}function g(t,n,i,e,o){return t[0]=n,t[1]=i,t[2]=e,t[3]=o,t}function M(t,n,i){let e=n[0],o=n[1],r=n[2],l=n[3],s=i[0],c=i[1],a=i[2],f=i[3];return t[0]=e*f+l*s+o*a-r*c,t[1]=o*f+l*c+r*s-e*a,t[2]=r*f+l*a+e*c-o*s,t[3]=l*f-e*s-o*c-r*a,t}function p(t,n,i,e){let o=Math.sin(n/2*sn),r=Math.cos(n/2*sn),l=Math.sin(i/2*sn),s=Math.cos(i/2*sn),c=Math.sin(e/2*sn),a=Math.cos(e/2*sn);return t[0]=o*s*a+r*l*c,t[1]=r*l*a-o*s*c,t[2]=r*s*c-o*l*a,t[3]=r*s*a+o*l*c,t}function w(t){return 57.29577951308232*Math.asin(-s(-1,1,2*(t[1]*t[2]-t[3]*t[0])))}function y(t,n,i){let e=i/2;return t[0]=Math.sin(e)*n[0],t[1]=Math.sin(e)*n[1],t[2]=Math.sin(e)*n[2],t[3]=Math.cos(e),t}function b(t,n,i,e){let o,r,l,s,c,a=n[0],f=n[1],u=n[2],h=n[3],d=i[0],v=i[1],m=i[2],_=i[3];return r=a*d+f*v+u*m+h*_,r<0&&(r=-r,d=-d,v=-v,m=-m,_=-_),1-r>1e-6?(o=Math.acos(r),l=Math.sin(o),s=Math.sin((1-e)*o)/l,c=Math.sin(e*o)/l):(s=1-e,c=e),t[0]=s*a+c*d,t[1]=s*f+c*v,t[2]=s*u+c*m,t[3]=s*h+c*_,t}function A(t){return(n,i)=>{let e={};for(let n in t){let{v:i,m:o=cn.Default}=t[n],r=i[i.length-1]._;e[n]={v:i.map((t=>({...t}))),m:o,g:r,M:0}}n.i.o[i]|=1,n.i.p[i]={A:e,k:e.idle}}}function k(t,n,i){let e=t.i.C[n],o=t.i.p[n];if(o.T){let t=o.A[o.T];t&&t!==o.k&&(0===o.k.M?o.k=t:1&o.k.m&&(o.k.M=0,o.k=t)),o.T=void 0}let r=null,l=null;for(let t of o.k.v){if(o.k.M<t._){l=t;break}r=t}if(r&&l){let i=(o.k.M-r._)/(l._-r._);l.D&&(i=l.D(i)),r.F&&l.F&&(_(e.F,r.F,l.F,i),t.i.o[n]|=256),r.$&&l.$&&(b(e.$,r.$,l.$,i),t.i.o[n]|=256),r.P&&l.P&&(_(e.P,r.P,l.P,i),t.i.o[n]|=256)}let s=o.k.M+i;if(s<o.k.g)o.k.M=s;else{if(o.k.M=0,4&o.k.m)for(let t of o.k.v.reverse())t._=o.k.g-t._;2&o.k.m||(o.k=o.A.idle)}}function E(t,n){let i=n[0],e=n[1],o=n[2],r=n[3],l=n[4],s=n[5],c=n[6],a=n[7],f=n[8],u=n[9],h=n[10],d=n[11],v=n[12],m=n[13],_=n[14],g=n[15],M=i*s-e*l,p=i*c-o*l,w=i*a-r*l,y=e*c-o*s,b=e*a-r*s,A=o*a-r*c,k=f*m-u*v,E=f*_-h*v,C=f*g-d*v,x=u*_-h*m,T=u*g-d*m,D=h*g-d*_,F=M*D-p*T+w*x+y*C-b*E+A*k;return F?(F=1/F,t[0]=(s*D-c*T+a*x)*F,t[1]=(o*T-e*D-r*x)*F,t[2]=(m*A-_*b+g*y)*F,t[3]=(h*b-u*A-d*y)*F,t[4]=(c*C-l*D-a*E)*F,t[5]=(i*D-o*C+r*E)*F,t[6]=(_*w-v*A-g*p)*F,t[7]=(f*A-h*w+d*p)*F,t[8]=(l*T-s*C+a*k)*F,t[9]=(e*C-i*T-r*k)*F,t[10]=(v*b-m*w+g*M)*F,t[11]=(u*w-f*b-d*M)*F,t[12]=(s*E-l*x-c*k)*F,t[13]=(i*x-e*E+o*k)*F,t[14]=(m*p-v*y-_*M)*F,t[15]=(f*y-u*p+h*M)*F,t):null}function C(t,n,i){let e=n[0],o=n[1],r=n[2],l=n[3],s=n[4],c=n[5],a=n[6],f=n[7],u=n[8],h=n[9],d=n[10],v=n[11],m=n[12],_=n[13],g=n[14],M=n[15],p=i[0],w=i[1],y=i[2],b=i[3];return t[0]=p*e+w*s+y*u+b*m,t[1]=p*o+w*c+y*h+b*_,t[2]=p*r+w*a+y*d+b*g,t[3]=p*l+w*f+y*v+b*M,p=i[4],w=i[5],y=i[6],b=i[7],t[4]=p*e+w*s+y*u+b*m,t[5]=p*o+w*c+y*h+b*_,t[6]=p*r+w*a+y*d+b*g,t[7]=p*l+w*f+y*v+b*M,p=i[8],w=i[9],y=i[10],b=i[11],t[8]=p*e+w*s+y*u+b*m,t[9]=p*o+w*c+y*h+b*_,t[10]=p*r+w*a+y*d+b*g,t[11]=p*l+w*f+y*v+b*M,p=i[12],w=i[13],y=i[14],b=i[15],t[12]=p*e+w*s+y*u+b*m,t[13]=p*o+w*c+y*h+b*_,t[14]=p*r+w*a+y*d+b*g,t[15]=p*l+w*f+y*v+b*M,t}function x(t,n,i,e){let o=n[0],r=n[1],l=n[2],s=n[3],c=o+o,a=r+r,f=l+l,u=o*c,h=o*a,d=o*f,v=r*a,m=r*f,_=l*f,g=s*c,M=s*a,p=s*f,w=e[0],y=e[1],b=e[2];return t[0]=(1-(v+_))*w,t[1]=(h+p)*w,t[2]=(d-M)*w,t[3]=0,t[4]=(h-p)*y,t[5]=(1-(u+_))*y,t[6]=(m+g)*y,t[7]=0,t[8]=(d+M)*b,t[9]=(m-g)*b,t[10]=(1-(u+v))*b,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function T(t,n,i,e,o,r,l){let s=1/(o-i),c=1/(e-n),a=1/(r-l);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*a,t[11]=0,t[12]=(o+i)*s,t[13]=(n+e)*c,t[14]=(l+r)*a,t[15]=1,t}function D(t,n){return t[0]=n[8],t[1]=n[9],t[2]=n[10],d(t,t)}function F(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function $(t,n){let i=function(t,n){let i=n[4],e=n[5],o=n[6],r=n[8],l=n[9],s=n[10];return t[0]=Math.hypot(n[0],n[1],n[2]),t[1]=Math.hypot(i,e,o),t[2]=Math.hypot(r,l,s),t}([0,0,0],n),e=1/i[0],o=1/i[1],r=1/i[2],l=n[0]*e,s=n[1]*o,c=n[2]*r,a=n[4]*e,f=n[5]*o,u=n[6]*r,h=n[8]*e,d=n[9]*o,v=n[10]*r,m=l+f+v,_=0;return m>0?(_=2*Math.sqrt(m+1),t[3]=.25*_,t[0]=(u-d)/_,t[1]=(h-c)/_,t[2]=(s-a)/_):l>f&&l>v?(_=2*Math.sqrt(1+l-f-v),t[3]=(u-d)/_,t[0]=.25*_,t[1]=(s+a)/_,t[2]=(h+c)/_):f>v?(_=2*Math.sqrt(1+f-l-v),t[3]=(h-c)/_,t[0]=(s+a)/_,t[1]=.25*_,t[2]=(u+d)/_):(_=2*Math.sqrt(1+v-l-f),t[3]=(s-a)/_,t[0]=(h+c)/_,t[1]=(u+d)/_,t[2]=.25*_),t}function P(t,n){let i=t[12]-n[0],e=t[13]-n[1],o=t[14]-n[2];return i*i+e*e+o*o}function S(t,n){let i=t.i.C[n];var e,o;F(un,i.i),D(hn,i.i),(e=dn)[0]=(o=i.i)[4],e[1]=o[5],e[2]=o[6],d(e,e);let r=t.Audio.listener;r.positionX?(r.positionX.value=un[0],r.positionY.value=un[1],r.positionZ.value=un[2],r.forwardX.value=hn[0],r.forwardY.value=hn[1],r.forwardZ.value=hn[2],r.upX.value=dn[0],r.upY.value=dn[1],r.upZ.value=dn[2]):(r.setPosition(...un),r.setOrientation(...hn,...dn))}function O(t=0,n=1){return((vn=16807*vn%2147483647)-1)/2147483646*(n-t)+t}function R(t,n,i,e,o){let r=t.currentTime+o,l=0;n&&n.connect(t.destination);let s,c,a=t.createGain();if(a.gain.value=(i[0]/9)**3,i[5]&&(c=t.createOscillator(),c.type=i[5],c.frequency.value=(i[7]/3)**3,s=t.createGain(),s.gain.value=(i[6]+3)**3,c.connect(s)),i[1]){let e=t.createBiquadFilter();e.type=i[1],e.frequency.value=2**i[2],e.Q.value=i[3]**1.5,s&&i[4]&&s.connect(e.detune),a.connect(e),e.connect(n||t.destination)}else a.connect(n||t.destination);for(let n of i[8]){let i=t.createGain();i.connect(a);let o=(n[1]/9)**3,c=(n[2]/9)**3,f=(n[3]/9)**3,u=c+f+(n[4]/6)**3;if(i.gain.setValueAtTime(0,r),i.gain.linearRampToValueAtTime(o,r+c),i.gain.setValueAtTime(o,r+c+f),i.gain.exponentialRampToValueAtTime(1e-5,r+u),n[0]){let o=t.createOscillator();o.type=n[0],o.connect(i),o.detune.value=3*(n[5]-7.5)**3,s&&n[6]&&s.connect(o.detune);let l=440*2**((e-69)/12);if(n[7]){let t=(n[8]/9)**3,i=(n[9]/9)**3,e=(n[10]/6)**3;o.frequency.linearRampToValueAtTime(0,r),o.frequency.linearRampToValueAtTime(l,r+t),o.frequency.setValueAtTime(l,r+t+i),o.frequency.exponentialRampToValueAtTime(1e-5,r+t+i+e)}else o.frequency.setValueAtTime(l,r);o.start(r),o.stop(r+u)}else{let n=t.createBufferSource();n.buffer=z(t),n.loop=!0,n.connect(i),n.start(r),n.stop(r+u)}u>l&&(l=u)}c&&(c.start(r),c.stop(r+l))}function z(t){if(!Kt){let n=(Kt=t.createBuffer(1,2*t.sampleRate,t.sampleRate)).getChannelData(0);for(let t=0;t<n.length;t++)n[t]=2*Math.random()-1}return Kt}function I(t,n,i){let e=t.i.S[n],o=t.i.C[n];if(e.k&&(e.M+=i,e.M>e.k.O?e.k=void 0:e.R&&K(e.R,o)),e.T&&!e.k){switch(e.T.I){case 0:!function(t,n,i){let e=t.createBufferSource();e.buffer=i.K,n?(e.connect(n),n.connect(t.destination)):e.connect(t.destination),e.start()}(t.Audio,e.R,e.T);break;case 1:!function(t,n,i){let e=60/(i.G||120)/4;for(let o of i.N)for(let i=0;i<o.L.length;i++)o.L[i]&&R(t,n,o.Y,o.L[i],i*e)}(t.Audio,e.R,e.T)}e.k=e.T,e.M=0,e.R&&K(e.R,o)}e.T=e.X}function K(t,n){F(_n,n.i),D(gn,n.i),t.positionX?(t.positionX.value=_n[0],t.positionY.value=_n[1],t.positionZ.value=_n[2],t.orientationX.value=gn[0],t.orientationY.value=gn[1],t.orientationZ.value=gn[2]):(t.setPosition(..._n),t.setOrientation(...gn))}function G(t,n=[.9,.9,.9,1],i=16640){return(e,o)=>{e.i.o[o]|=8,e.i.j[o]={I:0,B:t,V:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],U:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],W:[0,0,0],H:n,q:t.J,Z:n,tt:i}}}function N(t,n,i){let e=t.i.C[n],o=i.B;var r,l;(r=i.V)[0]=(l=e.nt)[0],r[1]=l[1],r[2]=l[2],r[3]=l[3],r[4]=l[4],r[5]=l[5],r[6]=l[6],r[7]=l[7],r[8]=l[8],r[9]=l[9],r[10]=l[10],r[11]=l[11],r[12]=l[12],r[13]=l[13],r[14]=l[14],r[15]=l[15],C(i.U,o.B,i.V),F(i.W,e.i)}function L(t,n){let i,e,o,r,l,s;F(n.it,t),i=r=n.it[0],e=l=n.it[1],o=s=n.it[2];let c=[0,0,0];for(let a=0;a<8;a++){let f=pn[a];c[0]=f[0]*n.et[0],c[1]=f[1]*n.et[1],c[2]=f[2]*n.et[2],v(c,c,t),c[0]<i&&(i=c[0]),c[0]>r&&(r=c[0]),c[1]<e&&(e=c[1]),c[1]>l&&(l=c[1]),c[2]<o&&(o=c[2]),c[2]>s&&(s=c[2])}n.ot=[i,e,o],n.rt=[r,l,s],n.lt[0]=(r-i)/2,n.lt[1]=(l-e)/2,n.lt[2]=(s-o)/2}function Y(t,n){let i=t.it[0]-n.it[0],e=t.lt[0]+n.lt[0]-Math.abs(i),o=t.it[1]-n.it[1],r=t.lt[1]+n.lt[1]-Math.abs(o),l=t.it[2]-n.it[2],s=t.lt[2]+n.lt[2]-Math.abs(l);return e<r&&e<s?[e*Math.sign(i),0,0]:r<s?[0,r*Math.sign(o),0]:[0,0,s*Math.sign(l)]}function X(t,n,i){for(let r=0;r<i;r++){let i=n[r],l=t.st&i.ct,s=i.st&t.ct;if((l||s)&&(e=t).ot[0]<(o=i).rt[0]&&e.rt[0]>o.ot[0]&&e.ot[1]<o.rt[1]&&e.rt[1]>o.ot[1]&&e.ot[2]<o.rt[2]&&e.rt[2]>o.ot[2]){let n=Y(t,i);l&&t.ft.push({ut:i.ht,dt:n}),s&&i.ft.push({ut:t.ht,dt:h([0,0,0],n)})}}var e,o}function j(t,n){let i=t.i.vt[n],e=t.i._t[n];i.gt&&f(e.gt,e.gt,i.gt),i.$&&M(e.Mt,e.Mt,i.$)}function B(t){return t*t}function V(t){return 1-(1-t)**2}function U(t){return t<.5?2*t*t:1-(-2*t+2)**2/2}function W(t,n,i,e=[1,1,1]){return(o,r)=>{o.i.o[r]|=32,o.i.wt[r]={ht:r,yt:!0,bt:t,ct:n,st:i,et:e,ot:[0,0,0],rt:[0,0,0],it:[0,0,0],lt:[0,0,0],ft:[]}}}function H(t,n,i,e=0,o=0,r=[1,1,1],l=2304){return(s,c)=>{s.i.o[c]|=65536,s.i.At[c]={I:1,kt:t,Et:n,Ct:i[3]<1?1:0,xt:l,Tt:i,Dt:[...r,e],Ft:[i[0],i[1],i[2],o]}}}function q(t,n=.5){return(i,e)=>{i.i.o[e]|=131072,i.i.$t[e]={I:t,Pt:e,St:n,Ot:[0,0,0],Rt:[0,0,0],zt:[0,0,0],It:[0,0,0],Kt:!1}}}function J(t=[0,0,0],n=[0,0,0,1],i=[1,1,1]){return(e,o)=>{e.i.o[o]|=4194560,e.i.C[o]={i:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],nt:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],F:t,$:n,P:i,Gyroscope:!1}}}function Q(t){return[W(!1,2,0),q(0),(t,n)=>{t.i.o[n]|=2048,t.i.Gt[n]={Nt:10,Lt:void 0}},n([J(),H(t.Yt,t.Xt,[0,1,.1,1]),A({idle:{m:0,v:[{_:1/0,F:[0,0,0]}]},drop:{m:0,v:[{_:0,F:[0,15,0]},{_:2,F:[0,O(-.1,.2),0],D:V}]}})])]}function Z(t,n){let i=[0,0,0];F(i,t.i.C[n].i),i[2]<t.jt&&(t.jt=i[2])}function tt(t,n){let e=t.i.$t[n];if(t.i.Vt[n].Bt&&t.Ut.Space&&!e.Kt){e.Ot[1]+=300;for(let e of i(t.i,n,1))t.i.p[e].T="jump"}}function nt(t,n){let i=t.i.Vt[n];if(i.Wt){let i=t.i._t[n];t.Ut.ArrowLeft&&M(i.Mt,i.Mt,[0,1,0,0]),t.Ut.ArrowRight&&M(i.Mt,i.Mt,[0,-1,0,0])}if(i.Ht){let e=t.i._t[n],o=w(t.i.C[n].$);t.Ut.ArrowUp&&o>i.qt&&M(e.Jt,e.Jt,[-1,0,0,0]),t.Ut.ArrowDown&&o<i.Qt&&M(e.Jt,e.Jt,[1,0,0,0])}}function it(t,n){let i=t.i.C[n],e=t.i.Vt[n];if(e.Wt&&t.Zt.Touch1X&&(y(Cn,An,-t.Zt.Touch1X*e.Wt*10*sn),M(i.$,Cn,i.$),t.i.o[n]|=256),e.Ht&&t.Zt.Touch1Y){let o=w(i.$),r=s(e.qt-o,e.Qt-o,t.Zt.Touch1Y*e.Ht*10);y(Cn,kn,r*sn),M(i.$,i.$,Cn),t.i.o[n]|=256}}function et(t,n){let i=t.i.Vt[n];if(i.Wt&&Math.abs(t.Zt.pad0_axis_3)>.1){let i=t.i._t[n];M(i.Mt,i.Mt,y([0,0,0,1],xn,-t.Zt.pad0_axis_3*Math.PI))}if(i.Ht&&Math.abs(t.Zt.pad0_axis_4)>.1){let e=t.i._t[n],o=t.Zt.pad0_axis_4*Math.PI,r=w(t.i.C[n].$);(o<0&&r>i.qt||o>0&&r<i.Qt)&&M(e.Jt,e.Jt,y([0,0,0,1],Tn,o))}}function ot(t,n){t.tn.textAlign="center",t.tn.font=n.nn,t.tn.fillStyle=n.en,t.tn.fillText(n.Text,0,0)}function rt(t,n){t.tn.strokeStyle=n.on,t.tn.strokeRect(-n.et/2,-n.et/2,n.et,n.et)}function lt(t,n,i){let r=t.i.Gt[n];r.Nt-=i,r.Nt<0&&(r.Lt&&o(t,r.Lt,n),e(t.i,n))}function st(t,n,i){let e=t.i.rn[n],o=t.i.C[n];2===e.I?D($n,o.i):F($n,o.i),t.ln[4*i+0]=$n[0],t.ln[4*i+1]=$n[1],t.ln[4*i+2]=$n[2],t.ln[4*i+3]=e.I,t.sn[4*i+0]=e.on[0],t.sn[4*i+1]=e.on[1],t.sn[4*i+2]=e.on[2],t.sn[4*i+3]=e.cn}function ct(t,n,i){let e=t.i.C[n],o=t.i._t[n];if(0!==o.gt[0]||0!==o.gt[1]||0!==o.gt[2]){let l=Math.min(1,Math.hypot((r=o.gt)[0],r[1],r[2]));m(o.gt,o.gt,e.i),void 0!==e.an&&m(o.gt,o.gt,t.i.C[e.an].nt),d(o.gt,o.gt),u(o.gt,o.gt,l*o.fn*i),f(e.F,e.F,o.gt),t.i.o[n]|=256,c(o.gt,0,0,0)}var r;o.Mt[3]<1&&(b(o.Mt,On,o.Mt,Math.min(1,o.un/Math.PI*i)),M(e.$,o.Mt,e.$),t.i.o[n]|=256,g(o.Mt,0,0,0,1)),o.Jt[3]<1&&(b(o.Jt,On,o.Jt,Math.min(1,o.un/Math.PI*i)),M(e.$,e.$,o.Jt),t.i.o[n]|=256,g(o.Jt,0,0,0,1))}function at(t,n,i){let e=t.i.hn[n],o=t.i.C[n];e.dn+=i,e.dn>e.vn&&(e.dn=0,F(zn,o.i),D(In,o.i),e.mn.push(...zn,0),e.mn.push(...In,Math.random()));for(let t=0;t<e.mn.length;)e.mn[t+3]+=i,e.mn[t+3]>e.Gt?e.mn.splice(t,8):t+=8}function ft(t,n,i){let e=t.i.C[n],o=t.i.$t[n];if(1===o.I){a(o.Rt,o.zt),u(o.Ot,o.Ot,i),f(o.Rt,o.Rt,o.Ot),o.Rt[1]+=-9.81*i;let r=[0,0,0];u(r,o.Rt,i),f(e.F,e.F,r),t.i.o[n]|=256,c(o.Ot,0,0,0)}}function ut(t,n,i){let e=t.i.$t[n];var o,r,l;F(Nn,t.i.C[n].i),2===e.I&&((o=Ln)[0]=(r=Nn)[0]-(l=e.It)[0],o[1]=r[1]-l[1],o[2]=r[2]-l[2],u(e.Rt,Ln,1/i)),a(e.It,Nn)}function ht(t,n){let i=t.i.C[n],e=t.i.$t[n],o=t.i.wt[e.Pt];if(1===e.I){e.Kt=!0;let s=!1;for(let c=0;c<o.ft.length;c++){let h=o.ft[c];if(131072&t.i.o[h.ut]){s=!0,f(i.F,i.F,h.dt),t.i.o[n]|=256;let o=t.i.$t[h.ut];switch(o.I){case 0:d(Xn,h.dt),u(Xn,Xn,-2*((r=e.Rt)[0]*(l=Xn)[0]+r[1]*l[1]+r[2]*l[2])),f(e.zt,e.Rt,Xn);break;case 1:case 2:a(e.zt,o.Rt)}u(e.zt,e.zt,e.St),h.dt[1]>0&&e.zt[1]<1&&(e.zt[1]=0,e.Kt=!1)}}s||a(e.zt,e.Rt)}else 2===e.I&&a(e.zt,e.Rt);var r,l}function dt(t,n){if(16&t.o[n]){let i=t.l[n];for(let n of i.l)if(1048576&t.o[n])return!0}return!1}function vt(t,n,i,e){return t.bindTexture(Vt,n),t.texImage2D(Vt,0,34836,i,e,0,Yt,5126,null),t.texParameteri(Vt,Bt,9728),t.texParameteri(Vt,jt,9728),n}function mt(t,n,i,e){return t.bindTexture(Vt,n),t.texImage2D(Vt,0,33190,i,e,0,6402,5125,null),t.texParameteri(Vt,Bt,Xt),t.texParameteri(Vt,jt,Xt),t.texParameteri(Vt,34892,34894),t.texParameteri(Vt,10242,33071),t.texParameteri(Vt,10243,33071),n}function _t(t,n,i,e){n._n=i,n.gn=e,function(t,n,i,e){t.bindTexture(Vt,n),t.texImage2D(Vt,0,32856,i,e,0,Yt,5121,null),t.texParameteri(Vt,Bt,Xt),t.texParameteri(Vt,jt,Xt)}(t,n.Mn,n._n,n.gn),mt(t,n.pn,n._n,n.gn)}function gt(t,n,i,e){n._n=i,n.gn=e,function(t,n,i,e){t.bindTexture(Vt,n),t.texImage2D(Vt,0,34842,i,e,0,Yt,5126,null),t.texParameteri(Vt,Bt,Xt),t.texParameteri(Vt,jt,Xt)}(t,n.Mn,n._n,n.gn),mt(t,n.pn,n._n,n.gn)}function Mt(t,n,i,e){n._n=i,n.gn=e,vt(t,n.wn,n._n,n.gn),vt(t,n.yn,n._n,n.gn),vt(t,n.bn,n._n,n.gn),vt(t,n.An,n._n,n.gn),mt(t,n.pn,n._n,n.gn)}function pt(t,n,i){let e=null,o=null,r=[];for(let l=0;l<t.i.o.length;l++)if((t.i.o[l]&Bn)===Bn){let s=t.i.At[l];if(1===s.Ct){r.push(l);continue}s.kt!==e&&(e=s.kt,wt(t,s,n)),s.xt!==o&&(o=s.xt,t.kn.frontFace(s.xt)),yt(t,l,i)}r.sort(((i,e)=>{let o=t.i.C[i];return P(t.i.C[e].i,n.W)-P(o.i,n.W)})),t.kn.enable(3042);for(let l=0;l<r.length;l++){let s=r[l],c=t.i.At[s];c.kt!==e&&(e=c.kt,wt(t,c,n)),c.xt!==o&&(o=c.xt,t.kn.frontFace(c.xt)),yt(t,s,i)}t.kn.disable(3042)}function wt(t,n,i){switch(n.I){case 0:case 4:case 7:case 8:case 9:t.kn.useProgram(n.kt.En),t.kn.uniformMatrix4fv(n.kt.Cn.U,!1,i.U);break;case 1:case 5:case 6:t.kn.useProgram(n.kt.En),t.kn.uniformMatrix4fv(n.kt.Cn.U,!1,i.U),t.kn.uniform3fv(n.kt.Cn.xn,i.W),t.kn.uniform4fv(n.kt.Cn.ln,t.ln),t.kn.uniform4fv(n.kt.Cn.sn,t.sn);break;case 2:t.kn.useProgram(n.kt.En),t.kn.uniformMatrix4fv(n.kt.Cn.U,!1,i.U),t.kn.uniform3fv(n.kt.Cn.xn,i.W),t.kn.uniform4fv(n.kt.Cn.ln,t.ln),t.kn.uniform4fv(n.kt.Cn.sn,t.sn),t.kn.activeTexture(Ut),t.kn.bindTexture(Vt,t.Dn.Tn.pn),t.kn.uniform1i(n.kt.Cn.Fn,0);let e=function(t,n,i=0){for(let e=i;e<t.o.length;e++)if((t.o[e]&n)===n)return e}(t.i,4104);if(e){let i=t.i.j[e];if(2===i.I)throw Error("XR cameras cannot be shadow sources.");t.kn.uniformMatrix4fv(n.kt.Cn.$n,!1,i.U)}}}function yt(t,n,i){let e=t.i.C[n],o=t.i.At[n];switch(o.I){case 0:t.kn.uniformMatrix4fv(o.kt.Cn.i,!1,e.i),t.kn.uniform4fv(o.kt.Cn.on,o.on),t.kn.bindVertexArray(o.Et.Pn),t.kn.drawElements(o.kt.Sn,o.Et.On,Wt,0),t.kn.bindVertexArray(null);break;case 1:case 2:t.kn.uniformMatrix4fv(o.kt.Cn.i,!1,e.i),t.kn.uniformMatrix4fv(o.kt.Cn.nt,!1,e.nt),t.kn.uniform4fv(o.kt.Cn.Tt,o.Tt),t.kn.uniform4fv(o.kt.Cn.Dt,o.Dt),t.kn.uniform4fv(o.kt.Cn.Ft,o.Ft),t.kn.bindVertexArray(o.Et.Pn),t.kn.drawElements(o.kt.Sn,o.Et.On,Wt,0),t.kn.bindVertexArray(null);break;case 4:if(o.Rn===i)break;t.kn.uniformMatrix4fv(o.kt.Cn.i,!1,e.i),t.kn.uniform4fv(o.kt.Cn.on,o.on),t.kn.activeTexture(Ut),t.kn.bindTexture(Vt,o.Rn),t.kn.uniform1i(o.kt.Cn.zn,0),t.kn.bindVertexArray(o.Et.Pn),t.kn.drawElements(o.kt.Sn,o.Et.On,Wt,0),t.kn.bindVertexArray(null);break;case 5:if(o.Rn===i)break;t.kn.uniformMatrix4fv(o.kt.Cn.i,!1,e.i),t.kn.uniformMatrix4fv(o.kt.Cn.nt,!1,e.nt),t.kn.uniform4fv(o.kt.Cn.Tt,o.Tt),t.kn.uniform4fv(o.kt.Cn.Dt,o.Dt),t.kn.uniform4fv(o.kt.Cn.Ft,o.Ft),t.kn.activeTexture(Ut),t.kn.bindTexture(Vt,o.Rn),t.kn.uniform1i(o.kt.Cn.In,0),t.kn.bindVertexArray(o.Et.Pn),t.kn.drawElements(o.kt.Sn,o.Et.On,Wt,0),t.kn.bindVertexArray(null);break;case 6:if(o.In===i)break;t.kn.uniformMatrix4fv(o.kt.Cn.i,!1,e.i),t.kn.uniformMatrix4fv(o.kt.Cn.nt,!1,e.nt),t.kn.uniform4fv(o.kt.Cn.Tt,o.Tt),t.kn.activeTexture(33985),t.kn.bindTexture(Vt,o.In),t.kn.uniform1i(o.kt.Cn.In,1),t.kn.activeTexture(33986),t.kn.bindTexture(Vt,o.Kn),t.kn.uniform1i(o.kt.Cn.Kn,2),t.kn.activeTexture(33987),t.kn.bindTexture(Vt,o.Gn),t.kn.uniform1i(o.kt.Cn.Gn,3),t.kn.bindVertexArray(o.Et.Pn),t.kn.drawElements(o.kt.Sn,o.Et.On,Wt,0),t.kn.bindVertexArray(null);break;case 7:t.kn.uniformMatrix4fv(o.kt.Cn.i,!1,e.i),t.kn.uniform4fv(o.kt.Cn.on,o.on),t.kn.bindBuffer(Lt,o.Nn),t.kn.enableVertexAttribArray(0),t.kn.vertexAttribPointer(0,3,Ht,!1,0,0),t.kn.drawArrays(o.kt.Sn,0,o.On);break;case 8:{let i=t.i.hn[n];t.kn.uniform4fv(o.kt.Cn.Ln,o.Ln),t.kn.uniform4fv(o.kt.Cn.Yn,o.Yn),t.kn.uniform4f(o.kt.Cn.Xn,i.Gt,i.jn,...o.et);let e=Float32Array.from(i.mn);t.kn.bindBuffer(Lt,o.K),t.kn.bufferSubData(Lt,0,e),t.kn.enableVertexAttribArray(o.kt.Cn.Bn),t.kn.vertexAttribPointer(o.kt.Cn.Bn,4,Ht,!1,32,0),t.kn.enableVertexAttribArray(o.kt.Cn.gt),t.kn.vertexAttribPointer(o.kt.Cn.gt,3,Ht,!1,32,16),t.kn.drawArrays(o.kt.Sn,0,i.mn.length/8);break}}}function bt(t,n){switch(t.I){case 0:!function(t,n){(function(t,n,i,e,o){let r,l=1/Math.tan(n/2);t[0]=l/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(r=1/(e-o),t[10]=(o+e)*r,t[14]=2*o*e*r):(t[10]=-1,t[14]=-2*e)})(t.B,n>1?t.Vn:t.Vn/n,n,t.Un,t.J),E(t.Wn,t.B)}(t,n);break;case 1:!function(t,n){n>1?T(t.B,t.Hn/n,t.Hn,-t.Hn/n,-t.Hn,t.Un,t.J):T(t.B,t.Hn,t.Hn*n,-t.Hn,-t.Hn*n,t.Un,t.J),E(t.Wn,t.B)}(t,n)}}function At(t,n){let i=t.i.qn[n],e=t.i.C[n];e.F=[Math.random()-.5,Math.random()-.5,Math.random()-.5],u(e.F,e.F,2*i.Jn),t.i.o[n]|=256}function kt(n,i,e){let o=n.i.Qn[i];if(o.dn+=e,o.dn>o.Zn){o.dn=0;let e=n.i.C[i],r=[0,0,0];F(r,e.i);let l=[0,0,0,0];$(l,e.i),t(n,[...o.ti(n),J(r,l)])}}function Et(t,n,i){let e=t.i.ni[n];e.dn+=i,e.dn>e.vn&&(e.dn=0,e.ii?(e.ii=!1,t.i.o[n]&=~e.st):(e.ii=!0,t.i.o[n]|=e.st))}function Ct(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&Hn)===Hn&&xt(t.i,n,t.i.C[n])}function xt(t,n,i){if(t.o[n]&=-257,x(i.i,i.$,i.F,i.P),void 0!==i.an&&(C(i.i,t.C[i.an].i,i.i),i.Gyroscope&&(F(qn,i.i),x(i.i,i.$,qn,i.P))),E(i.nt,i.i),16&t.o[n]){let i=t.l[n];for(let e=0;e<i.l.length;e++){let o=i.l[e];if(4194304&t.o[o]){let i=t.C[o];i.an=n,xt(t,o,i)}}}}function Tt(t,n){let i=t.i.wt[n],e=t.i.T[n];for(let r of i.ft)e.st&t.i.wt[r.ut].ct&&o(t,e.Lt,[n,r.ut])}function Dt(t,...n){return t.reduce(((t,i)=>t+function(t){let n=t.shift();return"boolean"==typeof n||null==n?"":Array.isArray(n)?n.join(""):n}(n)+i))}function Ft(t,n=.1){return(i,e)=>{i.i.o[e]|=8192,i.i.ei[e]={oi:t,ri:n}}}function $t(t,n,i=0){for(let e=i;e<t.o.length;e++)if(32768&t.o[e]&&t.si[e].li===n)return e;throw`No entity named ${n}.`}function Pt(t){return[Ft($t(t.i,"camera anchor")),n([J([0,1,-6],[0,1,0,0]),G({I:0,Vn:1,Un:.1,J:1e3,B:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],Wn:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},[.1,.5,.8,1])])]}function St(t,n,i,e=0,o=0){return(r,l)=>{r.i.o[l]|=128,r.i.Vt[l]={Bt:t,Wt:n,Ht:i,qt:e,Qt:o}}}function Ot(t=[1,1,1],n=1){return(i,e)=>{i.i.o[e]|=4096,i.i.rn[e]={I:2,on:t,cn:n}}}function Rt(t=[1,1,1],n=1){return(i,e)=>{i.i.o[e]|=4096,i.i.rn[e]={I:3,on:t,cn:n}}}function zt(t,n){return(i,e)=>{i.i.o[e]|=16384,i.i._t[e]={fn:t,un:n,gt:[0,0,0],Mt:[0,0,0,1],Jt:[0,0,0,1]}}}function It(t){return[St(!0,.2,0),(i=[0,0,1],(t,n)=>{t.i.o[n]|=64,t.i.vt[n]={gt:i,$:null}}),zt(20,3),W(!0,1,2),q(1),(t,n)=>{t.i.o[n]|=4,t.i.S[n]={R:undefined,X:void 0,M:0}},(t,n)=>{t.i.o[n]|=2},n([J(),H(t.Yt,t.Xt,[1,.3,.2,1]),A({idle:{v:[{_:0,$:p([0,0,0,1],0,-5,0),D:U},{_:1,$:p([0,0,0,1],0,5,0),D:U}]},jump:{v:[{_:0,$:[0,0,0,1]},{_:.5,$:[1,0,0,0],D:B},{_:1,$:[0,0,0,-1],D:V}],m:0}})],[J(void 0,p([0,0,0,1],15,0,0)),(t,n)=>{t.i.o[n]|=32768,t.i.si[n]={li:"camera anchor"}},zt(0,3),St(!1,0,.2,-10,30)],[J([0,2,0]),Rt([1,1,1],5)])];var i}var Kt,Gt,Nt=35044,Lt=34962,Yt=6408,Xt=9729,jt=10240,Bt=10241,Vt=3553,Ut=33984,Wt=5123,Ht=5126,qt=document.getElementById("update"),Jt=document.getElementById("delta"),Qt=document.getElementById("fps"),Zt=1/60,tn=class extends class{constructor(t=1e4){this.o=[],this.ci=[],this.ai=t}t(){return this.ci.length>0?this.ci.pop():this.o.push(0)-1}u(t){this.o[t]=0,this.ci.push(t)}}{constructor(){super(...arguments),this.p=[],this.S=[],this.j=[],this.l=[],this.wt=[],this.vt=[],this.Vt=[],this.fi=[],this.hn=[],this.Gt=[],this.rn=[],this.ei=[],this._t=[],this.si=[],this.At=[],this.$t=[],this.qn=[],this.Qn=[],this.ui=[],this.ni=[],this.C=[],this.T=[]}},nn=Float32Array.from([-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5]),en=Float32Array.from([-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0]),on=Float32Array.from([.666667,.333333,.333333,.333333,.333333,0,.666667,0,.333333,.666667,0,.666667,0,.333333,.333333,.333333,.333333,.333333,0,.333333,0,0,.333333,0,.333333,.666667,.333333,.333333,.666667,.333333,.666667,.666667,1,.333333,.666667,.333333,.666667,0,1,0,.333333,.666667,.333333,1,0,1,0,.666667]),rn=Float32Array.from([]),ln=Uint16Array.from([23,22,20,22,21,20,19,18,16,18,17,16,15,14,12,14,13,12,11,10,8,10,9,8,7,6,4,6,5,4,3,2,0,2,1,0]),sn=Math.PI/180,cn=(t=>(t[t.None=0]="None",t[t.EarlyExit=1]="EarlyExit",t[t.Loop=2]="Loop",t[t.Alternate=4]="Alternate",t[t.Default=7]="Default",t))(cn||{}),an=4194305,fn=4194306,un=[0,0,0],hn=[0,0,0],dn=[0,0,0],vn=1,mn=4194308,_n=[0,0,0],gn=[0,0,0],Mn=4194312,pn=[[.5,.5,.5],[.5,.5,-.5],[-.5,.5,-.5],[-.5,.5,.5],[.5,-.5,.5],[.5,-.5,-.5],[-.5,-.5,-.5],[-.5,-.5,.5]],wn=4194336,yn=4194432,bn=131200,An=[0,1,0],kn=[1,0,0],En=[0,0],Cn=[0,0,0,0],xn=[0,1,0],Tn=[1,0,0],Dn=4194816,Fn=4198400,$n=[0,0,0],Pn=4202496,Sn=4210688,On=[0,0,0,1],Rn=4195328,zn=[0,0,0],In=[0,0,0],Kn=4325376,Gn=4325376,Nn=[0,0,0],Ln=[0,0,0],Yn=4325408,Xn=[0,0,0],jn=1048576,Bn=4259840,Vn=4456448,Un=4718592,Wn=2097152,Hn=4194560,qn=[0,0,0],Jn=12582944,Qn=new class extends class extends class{constructor(){this.hi=0,this.di=0,this.vi=window.innerWidth,this.mi=window.innerHeight,this._i=!0,this.Ut={MouseX:0,MouseY:0},this.Zt={MouseX:0,MouseY:0},this.gi={Mouse:0,Mouse0:0,Mouse1:0,Mouse2:0,Touch0:0,Touch1:0},this.Mi={},this.pi=document.querySelector("main"),document.addEventListener("visibilitychange",(()=>document.hidden?this.wi():this.yi())),this.pi.addEventListener("contextmenu",(t=>t.preventDefault())),this.pi.addEventListener("mousedown",(t=>{this.Ut["Mouse"+t.button]=1,this.Zt["Mouse"+t.button]=1})),this.pi.addEventListener("mouseup",(t=>{this.Ut["Mouse"+t.button]=0,this.Zt["Mouse"+t.button]=-1})),this.pi.addEventListener("mousemove",(t=>{this.Ut.MouseX=t.clientX,this.Ut.MouseY=t.clientY,this.Zt.MouseX=t.movementX,this.Zt.MouseY=t.movementY})),this.pi.addEventListener("wheel",(t=>{t.preventDefault(),this.Zt.WheelY=t.deltaY})),this.pi.addEventListener("touchstart",(t=>{t.target===this.pi&&t.preventDefault(),1===t.touches.length&&(this.Mi={});for(let n=0;n<t.touches.length;n++)this.Mi[t.touches[n].identifier]=n;for(let n=0;n<t.changedTouches.length;n++){let i=t.changedTouches[n],e=this.Mi[i.identifier];this.Ut["Touch"+e]=1,this.Ut[`Touch${e}X`]=i.clientX,this.Ut[`Touch${e}Y`]=i.clientY,this.Zt["Touch"+e]=1,this.Zt[`Touch${e}X`]=0,this.Zt[`Touch${e}Y`]=0}})),this.pi.addEventListener("touchmove",(t=>{t.target===this.pi&&t.preventDefault();for(let n=0;n<t.changedTouches.length;n++){let i=t.changedTouches[n],e=this.Mi[i.identifier];this.Zt[`Touch${e}X`]=i.clientX-this.Ut[`Touch${e}X`],this.Zt[`Touch${e}Y`]=i.clientY-this.Ut[`Touch${e}Y`],this.Ut[`Touch${e}X`]=i.clientX,this.Ut[`Touch${e}Y`]=i.clientY}})),this.pi.addEventListener("touchend",(t=>{t.target===this.pi&&t.preventDefault();for(let n=0;n<t.changedTouches.length;n++){let i=this.Mi[t.changedTouches[n].identifier];this.Ut["Touch"+i]=0,this.Zt["Touch"+i]=-1}})),this.pi.addEventListener("touchcancel",(t=>{for(let n=0;n<t.changedTouches.length;n++){let i=this.Mi[t.changedTouches[n].identifier];this.Ut["Touch"+i]=0,this.Zt["Touch"+i]=-1}})),window.addEventListener("keydown",(t=>{t.repeat||(this.Ut[t.code]=1,this.Zt[t.code]=1)})),window.addEventListener("keyup",(t=>{this.Ut[t.code]=0,this.Zt[t.code]=-1}))}yi(){let t=0,n=performance.now(),i=e=>{let o=(e-n)/1e3;for(n=e,this.hi=requestAnimationFrame(i),this.bi(o),t+=o;t>=Zt;)t-=Zt,this.Ai(Zt);this.ki(o),this.Ei(o)};this.wi(),i(n)}wi(){cancelAnimationFrame(this.hi),this.hi=0}bi(t){this.di=performance.now();let n=Math.abs(this.Zt.MouseX)+Math.abs(this.Zt.MouseY);this.gi.Mouse+=n,1===this.Ut.Mouse0&&(this.gi.Mouse0+=n),1===this.Ut.Mouse1&&(this.gi.Mouse1+=n),1===this.Ut.Mouse2&&(this.gi.Mouse2+=n),1===this.Ut.Touch0&&(this.gi.Touch0+=Math.abs(this.Zt.Touch0X)+Math.abs(this.Zt.Touch0Y)),1===this.Ut.Touch1&&(this.gi.Touch1+=Math.abs(this.Zt.Touch1X)+Math.abs(this.Zt.Touch1Y))}Ai(t){}ki(t){}Ei(t){this._i=!1,-1===this.Zt.Mouse0&&(this.gi.Mouse0=0),-1===this.Zt.Mouse1&&(this.gi.Mouse1=0),-1===this.Zt.Mouse2&&(this.gi.Mouse2=0),-1===this.Zt.Touch0&&(this.gi.Touch0=0),-1===this.Zt.Touch1&&(this.gi.Touch1=0);for(let t in this.Zt)this.Zt[t]=0;let n=performance.now()-this.di;qt&&(qt.textContent=n.toFixed(1)),Jt&&(Jt.textContent=(1e3*t).toFixed(1)),Qt&&(Qt.textContent=(1/t).toFixed())}}{constructor(){super(),this.Ci=document.querySelector("#billboard"),this.tn=this.Ci.getContext("2d"),this.xi=document.querySelector("#scene"),this.kn=this.xi.getContext("webgl2"),this.Audio=new AudioContext,this.Ti=[],this.Dn={},this.kn.enable(2929),this.kn.enable(2884),this.kn.blendFunc(770,771)}bi(t){super.bi(t),this.Ti=[]}}{constructor(){super(...arguments),this.i=new tn,this.Di=function(t,n=4){let i=r(t,"#version 300 es\n\nuniform mat4 pv;\nuniform mat4 world;\n\nlayout(location=0) in vec4 attr_position;\n\nvoid main() {\ngl_Position = pv * world * attr_position;\n}\n","#version 300 es\n\nprecision mediump float;\n\nuniform vec4 color;\n\nout vec4 frag_color;\n\nvoid main() {\nfrag_color = color;\n}\n");return{Sn:n,En:i,Cn:{U:t.getUniformLocation(i,"pv"),i:t.getUniformLocation(i,"world"),on:t.getUniformLocation(i,"color")}}}(this.kn,2),this.Yt=function(t){let n=r(t,"#version 300 es\n\nuniform mat4 pv;\nuniform mat4 world;\nuniform mat4 self;\n\nlayout(location=0) in vec4 attr_position;\nlayout(location=1) in vec3 attr_normal;\n\nout vec4 vert_position;\nout vec3 vert_normal;\n\nvoid main() {\nvert_position = world * attr_position;\nvert_normal = (vec4(attr_normal, 0.0) * self).xyz;\ngl_Position = pv * vert_position;\n}\n","#version 300 es\n\nprecision mediump float;\n\nuniform vec3 eye;\nuniform vec4 diffuse_color;\nuniform vec4 specular_color;\nuniform vec4 emissive_color;\nuniform vec4 light_positions[8];\nuniform vec4 light_details[8];\n\nin vec4 vert_position;\nin vec3 vert_normal;\n\nout vec4 frag_color;\n\n\n\n\n\n\nvec3 GAMMA_DECODE(vec3 rgb) {\nreturn pow(rgb, vec3(2.2));\n}\n\n\nvec4 GAMMA_DECODE(vec4 color) {\nreturn vec4(pow(color.rgb, vec3(2.2)), color.a);\n}\n\n\n\n\n\n\nvec3 GAMMA_ENCODE(vec3 rgb) {\nreturn pow(rgb, vec3(1.0 / 2.2));\n}\n\n\nvec4 GAMMA_ENCODE(vec4 color) {\nreturn vec4(pow(color.rgb, vec3(1.0 / 2.2)), color.a);\n}\n\n\nvoid main() {\nvec3 world_normal = normalize(vert_normal);\n\nvec3 view_dir = eye - vert_position.xyz;\nvec3 view_normal = normalize(view_dir);\n\n\nvec3 light_acc = GAMMA_DECODE(diffuse_color.rgb) * 0.1;\n\nfor (int i = 0; i < 8; i++) {\nint light_kind = int(light_positions[i].w);\nif (light_kind == 0) {\nbreak;\n}\n\nvec3 light_rgb = GAMMA_DECODE(light_details[i].rgb);\nfloat light_intensity = light_details[i].a;\n\nvec3 light_normal;\nif (light_kind == 2) {\nlight_normal = light_positions[i].xyz;\n} else if (light_kind == 3) {\nvec3 light_dir = light_positions[i].xyz - vert_position.xyz;\nfloat light_dist = length(light_dir);\nlight_normal = light_dir / light_dist;\n\nlight_intensity /= (light_dist * light_dist);\n}\n\nfloat diffuse_factor = dot(world_normal, light_normal);\nif (diffuse_factor > 0.0) {\n\nlight_acc += GAMMA_DECODE(diffuse_color.rgb) * diffuse_factor * light_rgb * light_intensity;\n\nif (specular_color.a > 0.0) {\n\n\n\n\n\n\nvec3 h = normalize(light_normal + view_normal);\nfloat specular_angle = max(dot(h, world_normal), 0.0);\nfloat specular_factor = pow(specular_angle, specular_color.a);\n\n\nlight_acc += GAMMA_DECODE(specular_color.rgb) * specular_factor * light_rgb * light_intensity;\n}\n}\n}\n\nvec3 emissive_rgb = GAMMA_DECODE(emissive_color.rgb) * emissive_color.a;\nfrag_color = vec4(GAMMA_ENCODE(light_acc + emissive_rgb), diffuse_color.a);\n}\n");return{Sn:4,En:n,Cn:{U:t.getUniformLocation(n,"pv"),i:t.getUniformLocation(n,"world"),nt:t.getUniformLocation(n,"self"),Tt:t.getUniformLocation(n,"diffuse_color"),Dt:t.getUniformLocation(n,"specular_color"),Ft:t.getUniformLocation(n,"emissive_color"),xn:t.getUniformLocation(n,"eye"),ln:t.getUniformLocation(n,"light_positions"),sn:t.getUniformLocation(n,"light_details")}}}(this.kn),this.Fi=function(t){let n=r(t,"#version 300 es\n\nuniform mat4 pv;\nuniform vec4 color_start;\nuniform vec4 color_end;\n\nuniform vec4 details;\n\n\nin vec4 attr_origin_age;\nin vec3 attr_direction;\n\nout vec4 vert_color;\n\nvoid main() {\n\nvec3 velocity = attr_direction * details.y;\ngl_Position = pv * vec4(attr_origin_age.xyz + velocity * attr_origin_age.w, 1.0);\n\n\nfloat t = attr_origin_age.w / details.x;\ngl_PointSize = mix(details.z, details.w, t);\nvert_color = mix(color_start, color_end, t);\n}\n","#version 300 es\n\nprecision mediump float;\n\nin vec4 vert_color;\n\nout vec4 frag_color;\n\nvoid main() {\nfrag_color = vert_color;\n}\n");return{Sn:0,En:n,Cn:{U:t.getUniformLocation(n,"pv"),Ln:t.getUniformLocation(n,"color_start"),Yn:t.getUniformLocation(n,"color_end"),Xn:t.getUniformLocation(n,"details"),Bn:t.getAttribLocation(n,"attr_origin_age"),gt:t.getAttribLocation(n,"attr_direction")}}}(this.kn),this.Xt=function(t){let n=t.createVertexArray();t.bindVertexArray(n);let i=t.createBuffer();t.bindBuffer(Lt,i),t.bufferData(Lt,nn,Nt),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,3,Ht,!1,0,0);let e=t.createBuffer();t.bindBuffer(Lt,e),t.bufferData(Lt,en,Nt),t.enableVertexAttribArray(1),t.vertexAttribPointer(1,3,Ht,!1,0,0);let o=t.createBuffer();t.bindBuffer(Lt,o),t.bufferData(Lt,on,Nt),t.enableVertexAttribArray(2),t.vertexAttribPointer(2,2,Ht,!1,0,0);let r=t.createBuffer();t.bindBuffer(Lt,r),t.bufferData(Lt,rn,Nt),t.enableVertexAttribArray(5),t.vertexAttribPointer(5,4,Ht,!1,0,0);let l=t.createBuffer();return t.bindBuffer(34963,l),t.bufferData(34963,ln,Nt),t.bindVertexArray(null),{Pn:n,Nn:i,$i:nn,Pi:e,Si:en,Oi:o,Ri:on,zi:r,Ii:rn,Ki:l,Gi:ln,On:ln.length}}(this.kn),this.ln=new Float32Array(32),this.sn=new Float32Array(32),this.h=0,this.jt=0,this.Ni=0}Ai(t){!function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&Kn)===Kn&&ft(t,i,n)}(this,t),Ct(this),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&Gn)===Gn&&ut(t,i,n)}(this,t),function(t,n){let i=[],e=[];for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&wn)===wn){let o=t.i.C[n],r=t.i.wt[n];r.ft=[],r.yt?(r.yt=!1,L(o.i,r)):r.bt?(L(o.i,r),e.push(r)):i.push(r)}for(let t=0;t<e.length;t++)X(e[t],i,i.length),X(e[t],e,t)}(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&Yn)===Yn&&ht(t,n)}(this),Ct(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&Jn)===Jn&&Tt(t,n)}(this)}ki(n){!function(t,n){let i=[];for(let e=0;e<t.i.o.length;e++)if((t.i.o[e]&jn)===jn){if(dt(t.i,e))continue;let o=t.i.ui[e];switch(o.I){case 0:o.Li(e)&&i.push(e);break;case 1:o.Nt-=n,o.Nt<0&&i.push(e)}}for(let n of i){let i=t.i.ui[n];i.Yi&&i.Yi(n),t.i.o[n]&=-1048577,0===t.i.o[n]&&t.i.u(n),delete t.i.ui[n]}}(this,n),function(t,n){if(t.vi==window.innerWidth&&t.mi==window.innerHeight||(t._i=!0),t._i){t.vi=t.xi.width=t.Ci.width=window.innerWidth,t.mi=t.xi.height=t.Ci.height=window.innerHeight;for(let n of Object.values(t.Dn))if(n.Xi)switch(n.I){case 0:_t(t.kn,n,t.vi,t.mi);break;case 1:gt(t.kn,n,t.vi,t.mi);break;case 2:Mt(t.kn,n,t.vi,t.mi)}for(let n=0;n<t.i.o.length;n++)if(8==(8&t.i.o[n])){let i=t.i.j[n];switch(i.I){case 0:bt(i.B,t.vi/t.mi);break;case 1:bt(i.B,i.oi._n/i.oi.gn)}}}}(this),function(t,n){for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&Mn)===Mn){let i=t.i.j[n];switch(i.I){case 0:case 1:N(t,n,i),t.Ti.push(n)}}}(this),function(t,n){for(let n=0;n<t.i.o.length;n++)16512==(16512&t.i.o[n])&&nt(t,n)}(this),function(t,n){1===t.Zt.Touch0&&(En[0]=t.Ut.Touch0X,En[1]=t.Ut.Touch0Y);for(let n=0;n<t.i.o.length;n++)16512==(16512&t.i.o[n])&&it(t,n)}(this),function(t,n){for(let n of navigator.getGamepads())n&&(t.Zt[`pad${n.index}_axis_1`]=n.axes[0],t.Zt[`pad${n.index}_axis_2`]=n.axes[1],t.Zt[`pad${n.index}_axis_3`]=n.axes[2],t.Zt[`pad${n.index}_axis_4`]=n.axes[3]);for(let n=0;n<t.i.o.length;n++)16512==(16512&t.i.o[n])&&et(t,n)}(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&bn)===bn&&tt(t,n)}(this),function(t,n){for(let n=0;n<t.i.o.length;n++)16448==(16448&t.i.o[n])&&j(t,n)}(this),function(n,e){for(let t=0;t<n.i.o.length;t++)(n.i.o[t]&yn)===yn&&Z(n,t);let o=-Math.floor(n.jt/10);var r;o>n.Ni&&(n.Ni=o,t(n,[...Q(n),J([0,0,10*-o-100],void 0,[10,1,10]),(r=(t,n)=>{for(let e of i(t.i,n,1))t.i.p[e].T="drop"},(t,n)=>{r(t,n)})]))}(this),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&an)===an&&k(t,i,n)}(this,n),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&Sn)===Sn&&ct(t,i,n)}(this,n),function(t,n){for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&Pn)===Pn){let i=t.i.C[n],e=t.i.ei[n],o=t.i.C[e.oi],r=F([0,0,0],o.i),l=$([0,0,0,0],o.i);_(i.F,i.F,r,e.ri),b(i.$,i.$,l,e.ri),t.i.o[n]|=256}}(this),function(t,n){for(let i=0;i<t.i.o.length;i++)2048==(2048&t.i.o[i])&&lt(t,i,n)}(this,n),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&Vn)==Vn&&At(t,n)}(this),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&Wn)==Wn&&Et(t,i,n)}(this,n),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&Un)==Un&&kt(t,i,n)}(this,n),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&Rn)==Rn&&at(t,i,n)}(this,n),Ct(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&fn)===fn&&S(t,n)}(this),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&mn)===mn&&I(t,i,n)}(this,n),function(t,n){t.ln.fill(0),t.sn.fill(0);let i=0;for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&Fn)===Fn&&st(t,n,i++)}(this),function(t,n){for(let n of t.Ti){let i=t.i.j[n];switch(i.I){case 0:t.kn.bindFramebuffer(36160,null),t.kn.viewport(0,0,t.vi,t.mi),t.kn.clearColor(...i.Z),t.kn.clear(i.tt),pt(t,i);break;case 1:0===i.oi.I&&(t.kn.bindFramebuffer(36160,i.oi.ji),t.kn.viewport(0,0,i.oi._n,i.oi.gn),t.kn.clearColor(...i.Z),t.kn.clear(i.tt),pt(t,i,i.oi.Mn))}}}(this),function(t,n){t.tn.resetTransform(),t.tn.clearRect(0,0,t.vi,t.mi);let i=[0,0,0],e=t.i.j[t.Ti[0]];if(e&&2!==e.I)for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&Dn)==Dn){if(F(i,t.i.C[n].i),v(i,i,e.U),i[2]<-1||i[2]>1)continue;t.tn.setTransform(1,0,0,1,.5*(i[0]+1)*t.vi,.5*(1-i[1])*t.mi);let o=t.i.fi[n];switch(o.I){case 0:ot(t,o);break;case 2:rt(t,o)}}}(this),function(t,n){let i=function(t){return Dt`<div>${Dt`
<div
style="
position: absolute;
top: 1vmin;
left: 1vmin;
background: #000;
color: #fff;
font: 13px Arial;
"
>
<button
onclick="$(${0})"
style="
padding: 1vmin;
background: #000;
color: #fff;
border: none;
"
>
${document.fullscreenElement?"Exit Fullscreen":"Enter Fullscreen"}
</button>
</div>
`} ${function(t){return Dt`
<div
style="
position: absolute;
right: 0;
bottom: 0;
left: 0;
height: 10vmin;

display: flex;
justify-content: space-around;
align-items: center;

background: rgba(0, 0, 0, 0.5);
color: #fff;
font: 24px Impact;
font-style: italic;
"
>
<div>Collected: ${t.h}</div>
<div>Distance: ${-t.jt.toFixed(0)}</div>
</div>
`}(t)}</div>`}(t);i!==Gt&&(t.pi.innerHTML=Gt=i)}(this)}};!function(n){n.i=new tn,n._i=!0,t(n,[...It(n),J([0,1,0],[0,1,0,0])]),t(n,[...Pt(n),J([0,1,0],[0,1,0,0])]),t(n,[J(void 0,p([0,0,0,1],-30,30,0)),Ot([1,1,1],.1)]);for(let i=0;i<11;i++)t(n,[...Q(n),J([0,0,10*-i],void 0,[10,1,10])])}(Qn),Qn.yi(),window.$=o.bind(null,Qn),window.game=Qn})();
</script>
