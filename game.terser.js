(()=>{function t(t,n){let i=t.i.t();for(let e of n)e(t,i);return i}function n(...n){return(i,e)=>{16&i.i.o[e]||(i.i.o[e]|=16,i.i.l[e]={l:[]});let o=i.i.l[e].l;for(let e of n){let n=t(i,e);o.push(n)}}}function*i(t,n,e){if((t.o[n]&e)===e&&(yield n),16&t.o[n])for(let o of t.l[n].l)yield*i(t,o,e)}function e(t,n){if(16&t.o[n])for(let i of t.l[n].l)e(t,i);t.u(n)}function o(t,n,i){switch(n){case 0:document.fullscreenElement?document.exitFullscreen():document.body.requestFullscreen();break;case 1:{let[n]=i;e(t.i,n),t.h++;break}case 2:t.v++}}function r(t,n,i){let e=t.createProgram();return t.attachShader(e,l(t,35633,n)),t.attachShader(e,l(t,35632,i)),t.linkProgram(e),e}function l(t,n,i){let e=t.createShader(n);return t.shaderSource(e,i),t.compileShader(e),e}function s(t,n,i){return Math.max(t,Math.min(n,i))}function c(t,n,i,e){return t[0]=n,t[1]=i,t[2]=e,t}function a(t,n){return t[0]=n[0],t[1]=n[1],t[2]=n[2],t}function u(t,n,i){return t[0]=n[0]+i[0],t[1]=n[1]+i[1],t[2]=n[2]+i[2],t}function f(t,n,i){return t[0]=n[0]*i,t[1]=n[1]*i,t[2]=n[2]*i,t}function h(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t}function d(t,n){let i=n[0],e=n[1],o=n[2],r=i*i+e*e+o*o;return r>0&&(r=1/Math.sqrt(r)),t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t}function v(t,n,i){let e=n[0],o=n[1],r=n[2],l=i[3]*e+i[7]*o+i[11]*r+i[15]||1;return t[0]=(i[0]*e+i[4]*o+i[8]*r+i[12])/l,t[1]=(i[1]*e+i[5]*o+i[9]*r+i[13])/l,t[2]=(i[2]*e+i[6]*o+i[10]*r+i[14])/l,t}function m(t,n,i){let e=n[0],o=n[1],r=n[2];return t[0]=i[0]*e+i[4]*o+i[8]*r,t[1]=i[1]*e+i[5]*o+i[9]*r,t[2]=i[2]*e+i[6]*o+i[10]*r,t}function _(t,n,i,e){let o=n[0],r=n[1],l=n[2];return t[0]=o+e*(i[0]-o),t[1]=r+e*(i[1]-r),t[2]=l+e*(i[2]-l),t}function M(t,n,i,e,o){return t[0]=n,t[1]=i,t[2]=e,t[3]=o,t}function g(t,n,i){let e=n[0],o=n[1],r=n[2],l=n[3],s=i[0],c=i[1],a=i[2],u=i[3];return t[0]=e*u+l*s+o*a-r*c,t[1]=o*u+l*c+r*s-e*a,t[2]=r*u+l*a+e*c-o*s,t[3]=l*u-e*s-o*c-r*a,t}function p(t,n,i,e){let o=Math.sin(n/2*vn),r=Math.cos(n/2*vn),l=Math.sin(i/2*vn),s=Math.cos(i/2*vn),c=Math.sin(e/2*vn),a=Math.cos(e/2*vn);return t[0]=o*s*a+r*l*c,t[1]=r*l*a-o*s*c,t[2]=r*s*c-o*l*a,t[3]=r*s*a+o*l*c,t}function w(t){return 57.29577951308232*Math.asin(-s(-1,1,2*(t[1]*t[2]-t[3]*t[0])))}function y(t,n,i){let e=i/2;return t[0]=Math.sin(e)*n[0],t[1]=Math.sin(e)*n[1],t[2]=Math.sin(e)*n[2],t[3]=Math.cos(e),t}function b(t,n,i,e){let o,r,l,s,c,a=n[0],u=n[1],f=n[2],h=n[3],d=i[0],v=i[1],m=i[2],_=i[3];return r=a*d+u*v+f*m+h*_,r<0&&(r=-r,d=-d,v=-v,m=-m,_=-_),1-r>1e-6?(o=Math.acos(r),l=Math.sin(o),s=Math.sin((1-e)*o)/l,c=Math.sin(e*o)/l):(s=1-e,c=e),t[0]=s*a+c*d,t[1]=s*u+c*v,t[2]=s*f+c*m,t[3]=s*h+c*_,t}function A(t,n,i){let e=t.i.m[n],o=t.i._[n];if(o.M){let t=o.g[o.M];t&&t!==o.p&&(0===o.p.A?o.p=t:1&o.p.k&&(o.p.A=0,o.p=t)),o.M=void 0}let r=null,l=null;for(let t of o.p.C){if(o.p.A<t.F){l=t;break}r=t}if(r&&l){let i=(o.p.A-r.F)/(l.F-r.F);l.D&&(i=l.D(i)),r.T&&l.T&&(_(e.T,r.T,l.T,i),t.i.o[n]|=256),r.S&&l.S&&(b(e.S,r.S,l.S,i),t.i.o[n]|=256),r.P&&l.P&&(_(e.P,r.P,l.P,i),t.i.o[n]|=256)}let s=o.p.A+i;if(s<o.p.$)o.p.A=s;else{if(o.p.A=0,4&o.p.k)for(let t of o.p.C.reverse())t.F=o.p.$-t.F;2&o.p.k||(o.p=o.g.idle)}}function k(t,n){let i=n[0],e=n[1],o=n[2],r=n[3],l=n[4],s=n[5],c=n[6],a=n[7],u=n[8],f=n[9],h=n[10],d=n[11],v=n[12],m=n[13],_=n[14],M=n[15],g=i*s-e*l,p=i*c-o*l,w=i*a-r*l,y=e*c-o*s,b=e*a-r*s,A=o*a-r*c,k=u*m-f*v,C=u*_-h*v,E=u*M-d*v,x=f*_-h*m,F=f*M-d*m,D=h*M-d*_,T=g*D-p*F+w*x+y*E-b*C+A*k;return T?(T=1/T,t[0]=(s*D-c*F+a*x)*T,t[1]=(o*F-e*D-r*x)*T,t[2]=(m*A-_*b+M*y)*T,t[3]=(h*b-f*A-d*y)*T,t[4]=(c*E-l*D-a*C)*T,t[5]=(i*D-o*E+r*C)*T,t[6]=(_*w-v*A-M*p)*T,t[7]=(u*A-h*w+d*p)*T,t[8]=(l*F-s*E+a*k)*T,t[9]=(e*E-i*F-r*k)*T,t[10]=(v*b-m*w+M*g)*T,t[11]=(f*w-u*b-d*g)*T,t[12]=(s*C-l*x-c*k)*T,t[13]=(i*x-e*C+o*k)*T,t[14]=(m*p-v*y-_*g)*T,t[15]=(u*y-f*p+h*g)*T,t):null}function C(t,n,i){let e=n[0],o=n[1],r=n[2],l=n[3],s=n[4],c=n[5],a=n[6],u=n[7],f=n[8],h=n[9],d=n[10],v=n[11],m=n[12],_=n[13],M=n[14],g=n[15],p=i[0],w=i[1],y=i[2],b=i[3];return t[0]=p*e+w*s+y*f+b*m,t[1]=p*o+w*c+y*h+b*_,t[2]=p*r+w*a+y*d+b*M,t[3]=p*l+w*u+y*v+b*g,p=i[4],w=i[5],y=i[6],b=i[7],t[4]=p*e+w*s+y*f+b*m,t[5]=p*o+w*c+y*h+b*_,t[6]=p*r+w*a+y*d+b*M,t[7]=p*l+w*u+y*v+b*g,p=i[8],w=i[9],y=i[10],b=i[11],t[8]=p*e+w*s+y*f+b*m,t[9]=p*o+w*c+y*h+b*_,t[10]=p*r+w*a+y*d+b*M,t[11]=p*l+w*u+y*v+b*g,p=i[12],w=i[13],y=i[14],b=i[15],t[12]=p*e+w*s+y*f+b*m,t[13]=p*o+w*c+y*h+b*_,t[14]=p*r+w*a+y*d+b*M,t[15]=p*l+w*u+y*v+b*g,t}function E(t,n,i,e){let o=n[0],r=n[1],l=n[2],s=n[3],c=o+o,a=r+r,u=l+l,f=o*c,h=o*a,d=o*u,v=r*a,m=r*u,_=l*u,M=s*c,g=s*a,p=s*u,w=e[0],y=e[1],b=e[2];return t[0]=(1-(v+_))*w,t[1]=(h+p)*w,t[2]=(d-g)*w,t[3]=0,t[4]=(h-p)*y,t[5]=(1-(f+_))*y,t[6]=(m+M)*y,t[7]=0,t[8]=(d+g)*b,t[9]=(m-M)*b,t[10]=(1-(f+v))*b,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}function x(t,n,i,e,o,r,l){let s=1/(o-i),c=1/(e-n),a=1/(r-l);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*a,t[11]=0,t[12]=(o+i)*s,t[13]=(n+e)*c,t[14]=(l+r)*a,t[15]=1,t}function F(t,n){return t[0]=n[8],t[1]=n[9],t[2]=n[10],d(t,t)}function D(t,n){return t[0]=n[12],t[1]=n[13],t[2]=n[14],t}function T(t,n){let i=function(t,n){let i=n[4],e=n[5],o=n[6],r=n[8],l=n[9],s=n[10];return t[0]=Math.hypot(n[0],n[1],n[2]),t[1]=Math.hypot(i,e,o),t[2]=Math.hypot(r,l,s),t}([0,0,0],n),e=1/i[0],o=1/i[1],r=1/i[2],l=n[0]*e,s=n[1]*o,c=n[2]*r,a=n[4]*e,u=n[5]*o,f=n[6]*r,h=n[8]*e,d=n[9]*o,v=n[10]*r,m=l+u+v,_=0;return m>0?(_=2*Math.sqrt(m+1),t[3]=.25*_,t[0]=(f-d)/_,t[1]=(h-c)/_,t[2]=(s-a)/_):l>u&&l>v?(_=2*Math.sqrt(1+l-u-v),t[3]=(f-d)/_,t[0]=.25*_,t[1]=(s+a)/_,t[2]=(h+c)/_):u>v?(_=2*Math.sqrt(1+u-l-v),t[3]=(h-c)/_,t[0]=(s+a)/_,t[1]=.25*_,t[2]=(f+d)/_):(_=2*Math.sqrt(1+v-l-u),t[3]=(s-a)/_,t[0]=(h+c)/_,t[1]=(f+d)/_,t[2]=.25*_),t}function S(t,n){let i=t[12]-n[0],e=t[13]-n[1],o=t[14]-n[2];return i*i+e*e+o*o}function P(t,n){let i=t.i.m[n];var e,o;D(gn,i.i),F(pn,i.i),(e=wn)[0]=(o=i.i)[4],e[1]=o[5],e[2]=o[6],d(e,e);let r=t.Audio.listener;r.positionX?(r.positionX.value=gn[0],r.positionY.value=gn[1],r.positionZ.value=gn[2],r.forwardX.value=pn[0],r.forwardY.value=pn[1],r.forwardZ.value=pn[2],r.upX.value=wn[0],r.upY.value=wn[1],r.upZ.value=wn[2]):(r.setPosition(...gn),r.setOrientation(...pn,...wn))}function $(t=0,n=1){return((yn=16807*yn%2147483647)-1)/2147483646*(n-t)+t}function O(t,n,i,e,o){let r=t.currentTime+o,l=0;n&&n.connect(t.destination);let s,c,a=t.createGain();if(a.gain.value=(i[0]/9)**3,i[5]&&(c=t.createOscillator(),c.type=i[5],c.frequency.value=(i[7]/3)**3,s=t.createGain(),s.gain.value=(i[6]+3)**3,c.connect(s)),i[1]){let e=t.createBiquadFilter();e.type=i[1],e.frequency.value=2**i[2],e.Q.value=i[3]**1.5,s&&i[4]&&s.connect(e.detune),a.connect(e),e.connect(n||t.destination)}else a.connect(n||t.destination);for(let n of i[8]){let i=t.createGain();i.connect(a);let o=(n[1]/9)**3,c=(n[2]/9)**3,u=(n[3]/9)**3,f=c+u+(n[4]/6)**3;if(i.gain.setValueAtTime(0,r),i.gain.linearRampToValueAtTime(o,r+c),i.gain.setValueAtTime(o,r+c+u),i.gain.exponentialRampToValueAtTime(1e-5,r+f),n[0]){let o=t.createOscillator();o.type=n[0],o.connect(i),o.detune.value=3*(n[5]-7.5)**3,s&&n[6]&&s.connect(o.detune);let l=440*2**((e-69)/12);if(n[7]){let t=(n[8]/9)**3,i=(n[9]/9)**3,e=(n[10]/6)**3;o.frequency.linearRampToValueAtTime(0,r),o.frequency.linearRampToValueAtTime(l,r+t),o.frequency.setValueAtTime(l,r+t+i),o.frequency.exponentialRampToValueAtTime(1e-5,r+t+i+e)}else o.frequency.setValueAtTime(l,r);o.start(r),o.stop(r+f)}else{let n=t.createBufferSource();n.buffer=R(t),n.loop=!0,n.connect(i),n.start(r),n.stop(r+f)}f>l&&(l=f)}c&&(c.start(r),c.stop(r+l))}function R(t){if(!Bt){let n=(Bt=t.createBuffer(1,2*t.sampleRate,t.sampleRate)).getChannelData(0);for(let t=0;t<n.length;t++)n[t]=2*Math.random()-1}return Bt}function I(t,n,i){let e=t.i.O[n],o=t.i.m[n];if(e.p&&(e.A+=i,e.A>e.p.R?e.p=void 0:e.I&&z(e.I,o)),e.M&&!e.p){switch(e.M.L){case 0:!function(t,n,i){let e=t.createBufferSource();e.buffer=i.K,n?(e.connect(n),n.connect(t.destination)):e.connect(t.destination),e.start()}(t.Audio,e.I,e.M);break;case 1:!function(t,n,i){let e=60/(i.G||120)/4;for(let o of i.N)for(let i=0;i<o.Y.length;i++)o.Y[i]&&O(t,n,o.X,o.Y[i],i*e)}(t.Audio,e.I,e.M)}e.p=e.M,e.A=0,e.I&&z(e.I,o)}e.M=e.B}function z(t,n){D(An,n.i),F(kn,n.i),t.positionX?(t.positionX.value=An[0],t.positionY.value=An[1],t.positionZ.value=An[2],t.orientationX.value=kn[0],t.orientationY.value=kn[1],t.orientationZ.value=kn[2]):(t.setPosition(...An),t.setOrientation(...kn))}function L(t,n=[.9,.9,.9,1],i=16640){return(e,o)=>{e.i.o[o]|=8,e.i.j[o]={L:0,V:t,U:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],W:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],q:[0,0,0],H:n,J:t.Z,tt:n,nt:i}}}function K(t,n,i){let e=t.i.m[n],o=i.V;var r,l;(r=i.U)[0]=(l=e.it)[0],r[1]=l[1],r[2]=l[2],r[3]=l[3],r[4]=l[4],r[5]=l[5],r[6]=l[6],r[7]=l[7],r[8]=l[8],r[9]=l[9],r[10]=l[10],r[11]=l[11],r[12]=l[12],r[13]=l[13],r[14]=l[14],r[15]=l[15],C(i.W,o.V,i.U),D(i.q,e.i)}function G(t,n){let i,e,o,r,l,s;D(n.et,t),i=r=n.et[0],e=l=n.et[1],o=s=n.et[2];let c=[0,0,0];for(let a=0;a<8;a++){let u=En[a];c[0]=u[0]*n.ot[0],c[1]=u[1]*n.ot[1],c[2]=u[2]*n.ot[2],v(c,c,t),c[0]<i&&(i=c[0]),c[0]>r&&(r=c[0]),c[1]<e&&(e=c[1]),c[1]>l&&(l=c[1]),c[2]<o&&(o=c[2]),c[2]>s&&(s=c[2])}n.rt=[i,e,o],n.lt=[r,l,s],n.st[0]=(r-i)/2,n.st[1]=(l-e)/2,n.st[2]=(s-o)/2}function N(t,n){let i=t.et[0]-n.et[0],e=t.st[0]+n.st[0]-Math.abs(i),o=t.et[1]-n.et[1],r=t.st[1]+n.st[1]-Math.abs(o),l=t.et[2]-n.et[2],s=t.st[2]+n.st[2]-Math.abs(l);return e<r&&e<s?[e*Math.sign(i),0,0]:r<s?[0,r*Math.sign(o),0]:[0,0,s*Math.sign(l)]}function Y(t,n,i){for(let r=0;r<i;r++){let i=n[r],l=t.ct&i.ut,s=i.ct&t.ut;if((l||s)&&(e=t).rt[0]<(o=i).lt[0]&&e.lt[0]>o.rt[0]&&e.rt[1]<o.lt[1]&&e.lt[1]>o.rt[1]&&e.rt[2]<o.lt[2]&&e.lt[2]>o.rt[2]){let n=N(t,i);l&&t.ft.push({ht:i.dt,vt:n}),s&&i.ft.push({ht:t.dt,vt:h([0,0,0],n)})}}var e,o}function X(t,n){let i=t.i._t[n],e=t.i.Mt[n];i.gt&&u(e.gt,e.gt,i.gt),i.S&&g(e.wt,e.wt,i.S)}function B(t,n){let e=t.i.yt[n];if(t.i.bt[n].Mt&&t.At.Space&&!e.kt){e.Ct[1]+=300;for(let e of i(t.i,n,1))t.i._[e].M="jump"}}function j(t,n){let i=t.i.bt[n];if(i.Mt){let i=t.i.Mt[n];t.At.KeyW&&(i.gt[2]+=1),t.At.KeyA&&(i.gt[0]+=1),t.At.KeyS&&(i.gt[2]-=1),t.At.KeyD&&(i.gt[0]-=1)}if(i.Et){let i=t.i.Mt[n];t.At.ArrowLeft&&g(i.wt,i.wt,[0,1,0,0]),t.At.ArrowRight&&g(i.wt,i.wt,[0,-1,0,0])}if(i.xt){let e=t.i.Mt[n],o=w(t.i.m[n].S);t.At.ArrowUp&&o>i.Ft&&g(e.Dt,e.Dt,[-1,0,0,0]),t.At.ArrowDown&&o<i.Tt&&g(e.Dt,e.Dt,[1,0,0,0])}}function V(t,n){let i=t.i.bt[n],e=t.i.m[n];if(i.Et&&t.St.MouseX&&(y($n,Pn,-t.St.MouseX*i.Et*vn),g(e.S,$n,e.S),t.i.o[n]|=256),i.xt&&t.St.MouseY){let o=w(e.S),r=s(i.Ft-o,i.Tt-o,t.St.MouseY*i.xt);y($n,Sn,r*vn),g(e.S,e.S,$n),t.i.o[n]|=256}}function U(t,n){let i=t.i.m[n],e=t.i.bt[n],o=t.i.Mt[n];if(e.Mt&&1===t.At.Touch0){let n=Math.min(t.Pt,t.$t)/4,i=(t.At.Touch0X-In[0])/n,e=(t.At.Touch0Y-In[1])/n;Math.abs(i)>.01&&(o.gt[0]+=s(-1,1,-i)),Math.abs(e)>.01&&(o.gt[2]+=s(-1,1,-e))}if(e.Et&&t.St.Touch1X&&(y(zn,On,-t.St.Touch1X*e.Et*10*vn),g(i.S,zn,i.S),t.i.o[n]|=256),e.xt&&t.St.Touch1Y){let o=w(i.S),r=s(e.Ft-o,e.Tt-o,t.St.Touch1Y*e.xt*10);y(zn,Rn,r*vn),g(i.S,i.S,zn),t.i.o[n]|=256}}function W(t,n){let i=t.i.bt[n];if(i.Mt){let i=t.i.Mt[n];Math.abs(t.St.pad0_axis_1)>Gn&&(i.gt[0]-=t.St.pad0_axis_1),Math.abs(t.St.pad0_axis_2)>Gn&&(i.gt[2]-=t.St.pad0_axis_2)}if(i.Et&&Math.abs(t.St.pad0_axis_3)>Gn){let i=t.i.Mt[n];g(i.wt,i.wt,y([0,0,0,1],Ln,-t.St.pad0_axis_3*Math.PI))}if(i.xt&&Math.abs(t.St.pad0_axis_4)>Gn){let e=t.i.Mt[n],o=t.St.pad0_axis_4*Math.PI,r=w(t.i.m[n].S);(o<0&&r>i.Ft||o>0&&r<i.Tt)&&g(e.Dt,e.Dt,y([0,0,0,1],Kn,o))}}function q(t,n,i,e=0,o=0,r=[1,1,1],l=2304){return(s,c)=>{s.i.o[c]|=65536,s.i.Ot[c]={L:1,Rt:t,It:n,zt:i[3]<1?1:0,Lt:l,Kt:i,Gt:[...r,e],Nt:[i[0],i[1],i[2],o]}}}function H(t=[0,0,0],n=[0,0,0,1],i=[1,1,1]){return(e,o)=>{e.i.o[o]|=4194560,e.i.m[o]={i:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],it:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],T:t,S:n,P:i,Gyroscope:!1}}}function J(t,n){t.Yt.textAlign="center",t.Yt.font=n.Xt,t.Yt.fillStyle=n.Bt,t.Yt.fillText(n.Text,0,0)}function Q(t,n){t.Yt.strokeStyle=n.jt,t.Yt.strokeRect(-n.ot/2,-n.ot/2,n.ot,n.ot)}function Z(t,n,i){let r=t.i.Vt[n];r.Ut-=i,r.Ut<0&&(r.Wt&&o(t,r.Wt,n),e(t.i,n))}function tt(t,n,i){let e=t.i.qt[n],o=t.i.m[n];2===e.L?F(Xn,o.i):D(Xn,o.i),t.Ht[4*i+0]=Xn[0],t.Ht[4*i+1]=Xn[1],t.Ht[4*i+2]=Xn[2],t.Ht[4*i+3]=e.L,t.Jt[4*i+0]=e.jt[0],t.Jt[4*i+1]=e.jt[1],t.Jt[4*i+2]=e.jt[2],t.Jt[4*i+3]=e.Qt}function nt(t,n,i){let e=t.i.m[n],o=t.i.Mt[n];if(0!==o.gt[0]||0!==o.gt[1]||0!==o.gt[2]){let l=Math.min(1,Math.hypot((r=o.gt)[0],r[1],r[2]));m(o.gt,o.gt,e.i),void 0!==e.Zt&&m(o.gt,o.gt,t.i.m[e.Zt].it),d(o.gt,o.gt),f(o.gt,o.gt,l*o.tn*i),u(e.T,e.T,o.gt),t.i.o[n]|=256,c(o.gt,0,0,0)}var r;o.wt[3]<1&&(b(o.wt,Vn,o.wt,Math.min(1,o.nn/Math.PI*i)),g(e.S,o.wt,e.S),t.i.o[n]|=256,M(o.wt,0,0,0,1)),o.Dt[3]<1&&(b(o.Dt,Vn,o.Dt,Math.min(1,o.nn/Math.PI*i)),g(e.S,e.S,o.Dt),t.i.o[n]|=256,M(o.Dt,0,0,0,1))}function it(t,n,i){let e=t.i.en[n],o=t.i.m[n];e.on+=i,e.on>e.rn&&(e.on=0,D(Wn,o.i),F(qn,o.i),e.ln.push(...Wn,0),e.ln.push(...qn,Math.random()));for(let t=0;t<e.ln.length;)e.ln[t+3]+=i,e.ln[t+3]>e.Vt?e.ln.splice(t,8):t+=8}function et(t,n=.5){return(i,e)=>{i.i.o[e]|=131072,i.i.yt[e]={L:t,sn:e,cn:n,Ct:[0,0,0],an:[0,0,0],un:[0,0,0],fn:[0,0,0],kt:!1}}}function ot(t,n,i){let e=t.i.m[n],o=t.i.yt[n];if(1===o.L){a(o.an,o.un),f(o.Ct,o.Ct,i),u(o.an,o.an,o.Ct),o.an[1]+=-9.81*i;let r=[0,0,0];f(r,o.an,i),u(e.T,e.T,r),t.i.o[n]|=256,c(o.Ct,0,0,0)}}function rt(t,n,i){let e=t.i.yt[n];var o,r,l;D(Qn,t.i.m[n].i),2===e.L&&((o=Zn)[0]=(r=Qn)[0]-(l=e.fn)[0],o[1]=r[1]-l[1],o[2]=r[2]-l[2],f(e.an,Zn,1/i)),a(e.fn,Qn)}function lt(t,n){let i=t.i.m[n],e=t.i.yt[n],o=t.i.hn[e.sn];if(1===e.L){e.kt=!0;let s=!1;for(let c=0;c<o.ft.length;c++){let h=o.ft[c];if(131072&t.i.o[h.ht]){s=!0,u(i.T,i.T,h.vt),t.i.o[n]|=256;let o=t.i.yt[h.ht];switch(o.L){case 0:d(ni,h.vt),f(ni,ni,-2*((r=e.an)[0]*(l=ni)[0]+r[1]*l[1]+r[2]*l[2])),u(e.un,e.an,ni);break;case 1:case 2:a(e.un,o.an)}f(e.un,e.un,e.cn),h.vt[1]>0&&e.un[1]<1&&(e.un[1]=0,e.kt=!1)}}s||a(e.un,e.an)}else 2===e.L&&a(e.un,e.an);var r,l}function st(t,n){if(16&t.o[n]){let i=t.l[n];for(let n of i.l)if(1048576&t.o[n])return!0}return!1}function ct(t,n,i,e){return t.bindTexture(Zt,n),t.texImage2D(Zt,0,34836,i,e,0,qt,5126,null),t.texParameteri(Zt,Qt,9728),t.texParameteri(Zt,Jt,9728),n}function at(t,n,i,e){return t.bindTexture(Zt,n),t.texImage2D(Zt,0,33190,i,e,0,6402,5125,null),t.texParameteri(Zt,Qt,Ht),t.texParameteri(Zt,Jt,Ht),t.texParameteri(Zt,34892,34894),t.texParameteri(Zt,10242,33071),t.texParameteri(Zt,10243,33071),n}function ut(t,n,i,e){n.dn=i,n.vn=e,function(t,n,i,e){t.bindTexture(Zt,n),t.texImage2D(Zt,0,32856,i,e,0,qt,5121,null),t.texParameteri(Zt,Qt,Ht),t.texParameteri(Zt,Jt,Ht)}(t,n.mn,n.dn,n.vn),at(t,n._n,n.dn,n.vn)}function ft(t,n,i,e){n.dn=i,n.vn=e,function(t,n,i,e){t.bindTexture(Zt,n),t.texImage2D(Zt,0,34842,i,e,0,qt,5126,null),t.texParameteri(Zt,Qt,Ht),t.texParameteri(Zt,Jt,Ht)}(t,n.mn,n.dn,n.vn),at(t,n._n,n.dn,n.vn)}function ht(t,n,i,e){n.dn=i,n.vn=e,ct(t,n.Mn,n.dn,n.vn),ct(t,n.gn,n.dn,n.vn),ct(t,n.pn,n.dn,n.vn),ct(t,n.wn,n.dn,n.vn),at(t,n._n,n.dn,n.vn)}function dt(t,n,i){let e=null,o=null,r=[];for(let l=0;l<t.i.o.length;l++)if((t.i.o[l]&ei)===ei){let s=t.i.Ot[l];if(1===s.zt){r.push(l);continue}s.Rt!==e&&(e=s.Rt,vt(t,s,n)),s.Lt!==o&&(o=s.Lt,t.yn.frontFace(s.Lt)),mt(t,l,i)}r.sort(((i,e)=>{let o=t.i.m[i];return S(t.i.m[e].i,n.q)-S(o.i,n.q)})),t.yn.enable(3042);for(let l=0;l<r.length;l++){let s=r[l],c=t.i.Ot[s];c.Rt!==e&&(e=c.Rt,vt(t,c,n)),c.Lt!==o&&(o=c.Lt,t.yn.frontFace(c.Lt)),mt(t,s,i)}t.yn.disable(3042)}function vt(t,n,i){switch(n.L){case 0:case 4:case 7:case 8:case 9:t.yn.useProgram(n.Rt.bn),t.yn.uniformMatrix4fv(n.Rt.An.W,!1,i.W);break;case 1:case 5:case 6:t.yn.useProgram(n.Rt.bn),t.yn.uniformMatrix4fv(n.Rt.An.W,!1,i.W),t.yn.uniform3fv(n.Rt.An.kn,i.q),t.yn.uniform4fv(n.Rt.An.Ht,t.Ht),t.yn.uniform4fv(n.Rt.An.Jt,t.Jt);break;case 2:t.yn.useProgram(n.Rt.bn),t.yn.uniformMatrix4fv(n.Rt.An.W,!1,i.W),t.yn.uniform3fv(n.Rt.An.kn,i.q),t.yn.uniform4fv(n.Rt.An.Ht,t.Ht),t.yn.uniform4fv(n.Rt.An.Jt,t.Jt),t.yn.activeTexture(tn),t.yn.bindTexture(Zt,t.En.Cn._n),t.yn.uniform1i(n.Rt.An.xn,0);let e=function(t,n,i=0){for(let e=i;e<t.o.length;e++)if((t.o[e]&n)===n)return e}(t.i,4104);if(e){let i=t.i.j[e];if(2===i.L)throw Error("XR cameras cannot be shadow sources.");t.yn.uniformMatrix4fv(n.Rt.An.Fn,!1,i.W)}}}function mt(t,n,i){let e=t.i.m[n],o=t.i.Ot[n];switch(o.L){case 0:t.yn.uniformMatrix4fv(o.Rt.An.i,!1,e.i),t.yn.uniform4fv(o.Rt.An.jt,o.jt),t.yn.bindVertexArray(o.It.Dn),t.yn.drawElements(o.Rt.Tn,o.It.Sn,nn,0),t.yn.bindVertexArray(null);break;case 1:case 2:t.yn.uniformMatrix4fv(o.Rt.An.i,!1,e.i),t.yn.uniformMatrix4fv(o.Rt.An.it,!1,e.it),t.yn.uniform4fv(o.Rt.An.Kt,o.Kt),t.yn.uniform4fv(o.Rt.An.Gt,o.Gt),t.yn.uniform4fv(o.Rt.An.Nt,o.Nt),t.yn.bindVertexArray(o.It.Dn),t.yn.drawElements(o.Rt.Tn,o.It.Sn,nn,0),t.yn.bindVertexArray(null);break;case 4:if(o.Pn===i)break;t.yn.uniformMatrix4fv(o.Rt.An.i,!1,e.i),t.yn.uniform4fv(o.Rt.An.jt,o.jt),t.yn.activeTexture(tn),t.yn.bindTexture(Zt,o.Pn),t.yn.uniform1i(o.Rt.An.$n,0),t.yn.bindVertexArray(o.It.Dn),t.yn.drawElements(o.Rt.Tn,o.It.Sn,nn,0),t.yn.bindVertexArray(null);break;case 5:if(o.Pn===i)break;t.yn.uniformMatrix4fv(o.Rt.An.i,!1,e.i),t.yn.uniformMatrix4fv(o.Rt.An.it,!1,e.it),t.yn.uniform4fv(o.Rt.An.Kt,o.Kt),t.yn.uniform4fv(o.Rt.An.Gt,o.Gt),t.yn.uniform4fv(o.Rt.An.Nt,o.Nt),t.yn.activeTexture(tn),t.yn.bindTexture(Zt,o.Pn),t.yn.uniform1i(o.Rt.An.On,0),t.yn.bindVertexArray(o.It.Dn),t.yn.drawElements(o.Rt.Tn,o.It.Sn,nn,0),t.yn.bindVertexArray(null);break;case 6:if(o.On===i)break;t.yn.uniformMatrix4fv(o.Rt.An.i,!1,e.i),t.yn.uniformMatrix4fv(o.Rt.An.it,!1,e.it),t.yn.uniform4fv(o.Rt.An.Kt,o.Kt),t.yn.activeTexture(33985),t.yn.bindTexture(Zt,o.On),t.yn.uniform1i(o.Rt.An.On,1),t.yn.activeTexture(33986),t.yn.bindTexture(Zt,o.Rn),t.yn.uniform1i(o.Rt.An.Rn,2),t.yn.activeTexture(33987),t.yn.bindTexture(Zt,o.In),t.yn.uniform1i(o.Rt.An.In,3),t.yn.bindVertexArray(o.It.Dn),t.yn.drawElements(o.Rt.Tn,o.It.Sn,nn,0),t.yn.bindVertexArray(null);break;case 7:t.yn.uniformMatrix4fv(o.Rt.An.i,!1,e.i),t.yn.uniform4fv(o.Rt.An.jt,o.jt),t.yn.bindBuffer(Wt,o.zn),t.yn.enableVertexAttribArray(0),t.yn.vertexAttribPointer(0,3,en,!1,0,0),t.yn.drawArrays(o.Rt.Tn,0,o.Sn);break;case 8:{let i=t.i.en[n];t.yn.uniform4fv(o.Rt.An.Ln,o.Ln),t.yn.uniform4fv(o.Rt.An.Kn,o.Kn),t.yn.uniform4f(o.Rt.An.Gn,i.Vt,i.Nn,...o.ot);let e=Float32Array.from(i.ln);t.yn.bindBuffer(Wt,o.K),t.yn.bufferSubData(Wt,0,e),t.yn.enableVertexAttribArray(o.Rt.An.Yn),t.yn.vertexAttribPointer(o.Rt.An.Yn,4,en,!1,32,0),t.yn.enableVertexAttribArray(o.Rt.An.gt),t.yn.vertexAttribPointer(o.Rt.An.gt,3,en,!1,32,16),t.yn.drawArrays(o.Rt.Tn,0,i.ln.length/8);break}}}function _t(t,n){switch(t.L){case 0:!function(t,n){(function(t,n,i,e,o){let r,l=1/Math.tan(n/2);t[0]=l/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(r=1/(e-o),t[10]=(o+e)*r,t[14]=2*o*e*r):(t[10]=-1,t[14]=-2*e)})(t.V,n>1?t.Xn:t.Xn/n,n,t.Bn,t.Z),k(t.jn,t.V)}(t,n);break;case 1:!function(t,n){n>1?x(t.V,t.Vn/n,t.Vn,-t.Vn/n,-t.Vn,t.Bn,t.Z):x(t.V,t.Vn,t.Vn*n,-t.Vn,-t.Vn*n,t.Bn,t.Z),k(t.jn,t.V)}(t,n)}}function Mt(t,n){let i=t.i.Un[n],e=t.i.m[n];e.T=[Math.random()-.5,Math.random()-.5,Math.random()-.5],f(e.T,e.T,2*i.Wn),t.i.o[n]|=256}function gt(n,i,e){let o=n.i.qn[i];if(o.on+=e,o.on>o.Hn){o.on=0;let e=n.i.m[i],r=[0,0,0];D(r,e.i);let l=[0,0,0,0];T(l,e.i),t(n,[...o.Jn(n),H(r,l)])}}function pt(t,n,i){let e=t.i.Qn[n];e.on+=i,e.on>e.rn&&(e.on=0,e.Zn?(e.Zn=!1,t.i.o[n]&=~e.ct):(e.Zn=!0,t.i.o[n]|=e.ct))}function wt(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&si)===si&&yt(t.i,n,t.i.m[n])}function yt(t,n,i){if(t.o[n]&=-257,E(i.i,i.S,i.T,i.P),void 0!==i.Zt&&(C(i.i,t.m[i.Zt].i,i.i),i.Gyroscope&&(D(ci,i.i),E(i.i,i.S,ci,i.P))),k(i.it,i.i),16&t.o[n]){let i=t.l[n];for(let e=0;e<i.l.length;e++){let o=i.l[e];if(4194304&t.o[o]){let i=t.m[o];i.Zt=n,yt(t,o,i)}}}}function bt(t,n){let i=t.i.hn[n],e=t.i.M[n];for(let r of i.ft)e.ct&t.i.hn[r.ht].ut&&o(t,e.Wt,[n,r.ht])}function At(t,...n){return t.reduce(((t,i)=>t+function(t){let n=t.shift();return"boolean"==typeof n||null==n?"":Array.isArray(n)?n.join(""):n}(n)+i))}function kt(t,n=.1){return(i,e)=>{i.i.o[e]|=8192,i.i.ti[e]={ni:t,ii:n}}}function Ct(t,n,i=0){for(let e=i;e<t.o.length;e++)if(32768&t.o[e]&&t.oi[e].ei===n)return e;throw`No entity named ${n}.`}function Et(t){return[kt(Ct(t.i,"camera anchor")),n([H([0,1,-6],[0,1,0,0]),L({L:0,Xn:1,Bn:.1,Z:1e3,V:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],jn:[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},[.1,.5,.8,1])])]}function xt(t,n,i,e=[1,1,1]){return(o,r)=>{o.i.o[r]|=32,o.i.hn[r]={dt:r,ri:!0,li:t,ut:n,ct:i,ot:e,rt:[0,0,0],lt:[0,0,0],et:[0,0,0],st:[0,0,0],ft:[]}}}function Ft(t){return[xt(!1,2,0),et(0),n([H([0,$(-.2,.2),0]),q(t.si,t.ci,[0,1,.1,1])])]}function Dt(t,n){return(i,e)=>{let o=t?i.Audio.createPanner():void 0;i.i.o[e]|=4,i.i.O[e]={I:o,B:n,A:0}}}function Tt(t){return(n,i)=>{t(n,i)}}function St(t,n){return(i,e)=>{i.i.o[e]|=64,i.i._t[e]={gt:t,S:n}}}function Pt(t){return(n,i)=>{n.i.o[i]&=~t}}function $t(t=[1,1,1],n=1){return(i,e)=>{i.i.o[e]|=4096,i.i.qt[e]={L:2,jt:t,Qt:n}}}function Ot(t=[1,1,1],n=1){return(i,e)=>{i.i.o[e]|=4096,i.i.qt[e]={L:3,jt:t,Qt:n}}}function Rt(t,n){return(i,e)=>{i.i.o[e]|=16384,i.i.Mt[e]={tn:t,nn:n,gt:[0,0,0],wt:[0,0,0,1],Dt:[0,0,0,1]}}}function It(t){return(n,i)=>{n.i.o[i]|=262144,n.i.Un[i]={Wn:t}}}function zt(t){let i,e;return[xt(!0,8,3),(t,n)=>{t.i.o[n]|=8388608,t.i.M[n]={ct:1,Wt:1}},et(1,.3),Dt(!0),(s=5,c=2,(t,n)=>{t.i.o[n]|=2048,t.i.Vt[n]={Ut:s,Wt:c}}),Pt(2048),n([Tt(((t,n)=>i=n)),H(void 0,void 0,[.5,.7,.1]),St(null,[0,1,0,0]),Rt(0,.2),It(.05),(o=262144,r=1,l=!0,(t,n)=>{t.i.o[n]|=2097152,t.i.Qn[n]={ct:o,rn:r,on:r,Zn:!l}}),Pt(2359296),n([H([0,1,0]),q(t.si,t.ci,[5,3,0,1]),n([H([0,1,0]),Ot([1,.5,0],3)])])],[H([0,1.5,0]),St(null,[0,1,0,0]),Rt(0,2),n([H([0,0,.2],p([0,0,0,1],-90,0,0)),n([Tt(((t,n)=>e=n)),H(),It(.05),(t,n)=>{t.i.o[n]|=1024,t.i.en[n]={Vt:2,rn:.2,Nn:1,ln:[],on:0}},(u=t.ai,f=[1,1,1,1],h=[1,1,1,0],(t,n)=>{let i=t.yn.createBuffer();t.yn.bindBuffer(Wt,i),t.yn.bufferData(Wt,6400,35048),t.i.o[n]|=65536,t.i.Ot[n]={L:8,Rt:u,zt:f[3]<1||h[3]<1?1:0,K:i,Ln:f,Kn:h,ot:[5,1],Lt:2304}})])])]),(a=n=>{t.i.o[n]|=2048,t.i.o[i]|=2359296,t.i.Un[e].Wn=.1;let o=t.i.en[e];o.Vt=1,o.rn=.1;let r=t.i.Ot[e];r.Ln=[1,1,0,1],r.Kn=[1,0,0,0],r.ot=[10,5]},(t,n)=>{t.i.o[n]|=1048576,t.i.ui[n]={L:1,Ut:10,fi:a}})];var o,r,l,s,c,a,u,f,h}function Lt(t){return[xt(!0,4,3),et(1,.3),n([H(),q(t.si,t.ci,[.5,.5,.5,.3])])]}function Kt(t){return t*t}function Gt(t){return 1-(1-t)**2}function Nt(t){return t<.5?2*t*t:1-(-2*t+2)**2/2}function Yt(t,n,i,e=0,o=0){return(r,l)=>{r.i.o[l]|=128,r.i.bt[l]={Mt:t,Et:n,xt:i,Ft:e,Tt:o}}}function Xt(t){return[Yt(!0,.2,0),Rt(10,3),xt(!0,1,2),et(1),Dt(!1),(t,n)=>{t.i.o[n]|=2},n([H(),q(t.si,t.ci,[1,.3,.2,1]),(i={idle:{C:[{F:0,S:p([0,0,0,1],0,-5,0),D:Nt},{F:1,S:p([0,0,0,1],0,5,0),D:Nt}]},jump:{C:[{F:0,S:[0,0,0,1]},{F:.5,S:[1,0,0,0],D:Kt},{F:1,S:[0,0,0,-1],D:Gt}],k:0}},(t,n)=>{let e={};for(let t in i){let{C:n,k:o=mn.Default}=i[t],r=n[n.length-1].F;e[t]={C:n.map((t=>({...t}))),k:o,$:r,A:0}}t.i.o[n]|=1,t.i._[n]={g:e,p:e.idle}})],[H(),(t,n)=>{t.i.o[n]|=32768,t.i.oi[n]={ei:"camera anchor"}},Rt(0,3),Yt(!1,0,.2,-10,80)],[H([0,2,0]),Ot([1,1,1],5)])];var i}var Bt,jt,Vt,Ut=35044,Wt=34962,qt=6408,Ht=9729,Jt=10240,Qt=10241,Zt=3553,tn=33984,nn=5123,en=5126,on=document.getElementById("update"),rn=document.getElementById("delta"),ln=document.getElementById("fps"),sn=1/60,cn=class extends class{constructor(t=1e4){this.o=[],this.hi=[],this.di=t}t(){return this.hi.length>0?this.hi.pop():this.o.push(0)-1}u(t){this.o[t]=0,this.hi.push(t)}}{constructor(){super(...arguments),this._=[],this.O=[],this.j=[],this.l=[],this.hn=[],this._t=[],this.bt=[],this.vi=[],this.en=[],this.Vt=[],this.qt=[],this.ti=[],this.Mt=[],this.oi=[],this.Ot=[],this.yt=[],this.Un=[],this.qn=[],this.ui=[],this.Qn=[],this.m=[],this.M=[]}},an=Float32Array.from([-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,.5]),un=Float32Array.from([-1,0,0,-1,0,0,-1,0,0,-1,0,0,0,0,-1,0,0,-1,0,0,-1,0,0,-1,1,0,0,1,0,0,1,0,0,1,0,0,0,0,1,0,0,1,0,0,1,0,0,1,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0]),fn=Float32Array.from([.666667,.333333,.333333,.333333,.333333,0,.666667,0,.333333,.666667,0,.666667,0,.333333,.333333,.333333,.333333,.333333,0,.333333,0,0,.333333,0,.333333,.666667,.333333,.333333,.666667,.333333,.666667,.666667,1,.333333,.666667,.333333,.666667,0,1,0,.333333,.666667,.333333,1,0,1,0,.666667]),hn=Float32Array.from([]),dn=Uint16Array.from([23,22,20,22,21,20,19,18,16,18,17,16,15,14,12,14,13,12,11,10,8,10,9,8,7,6,4,6,5,4,3,2,0,2,1,0]),vn=Math.PI/180,mn=(t=>(t[t.None=0]="None",t[t.EarlyExit=1]="EarlyExit",t[t.Loop=2]="Loop",t[t.Alternate=4]="Alternate",t[t.Default=7]="Default",t))(mn||{}),_n=4194305,Mn=4194306,gn=[0,0,0],pn=[0,0,0],wn=[0,0,0],yn=1,bn=4194308,An=[0,0,0],kn=[0,0,0],Cn=4194312,En=[[.5,.5,.5],[.5,.5,-.5],[-.5,.5,-.5],[-.5,.5,.5],[.5,-.5,.5],[.5,-.5,-.5],[-.5,-.5,-.5],[-.5,-.5,.5]],xn=4194336,Fn=4210752,Dn=131200,Tn=4210816,Sn=[1,0,0],Pn=[0,1,0],$n=[0,0,0,0],On=[0,1,0],Rn=[1,0,0],In=[0,0],zn=[0,0,0,0],Ln=[0,1,0],Kn=[1,0,0],Gn=.1,Nn=4194816,Yn=4198400,Xn=[0,0,0],Bn=4202496,jn=4210688,Vn=[0,0,0,1],Un=4195328,Wn=[0,0,0],qn=[0,0,0],Hn=4325376,Jn=4325376,Qn=[0,0,0],Zn=[0,0,0],ti=4325408,ni=[0,0,0],ii=1048576,ei=4259840,oi=4456448,ri=4718592,li=2097152,si=4194560,ci=[0,0,0],ai=12582944,ui=new class extends class extends class{constructor(){this.mi=0,this._i=0,this.Pt=window.innerWidth,this.$t=window.innerHeight,this.Mi=!0,this.At={MouseX:0,MouseY:0},this.St={MouseX:0,MouseY:0},this.gi={Mouse:0,Mouse0:0,Mouse1:0,Mouse2:0,Touch0:0,Touch1:0},this.pi={},this.wi=document.querySelector("main"),document.addEventListener("visibilitychange",(()=>document.hidden?this.yi():this.bi())),this.wi.addEventListener("contextmenu",(t=>t.preventDefault())),this.wi.addEventListener("mousedown",(t=>{this.At["Mouse"+t.button]=1,this.St["Mouse"+t.button]=1})),this.wi.addEventListener("mouseup",(t=>{this.At["Mouse"+t.button]=0,this.St["Mouse"+t.button]=-1})),this.wi.addEventListener("mousemove",(t=>{this.At.MouseX=t.clientX,this.At.MouseY=t.clientY,this.St.MouseX=t.movementX,this.St.MouseY=t.movementY})),this.wi.addEventListener("wheel",(t=>{t.preventDefault(),this.St.WheelY=t.deltaY})),this.wi.addEventListener("touchstart",(t=>{t.target===this.wi&&t.preventDefault(),1===t.touches.length&&(this.pi={});for(let n=0;n<t.touches.length;n++)this.pi[t.touches[n].identifier]=n;for(let n=0;n<t.changedTouches.length;n++){let i=t.changedTouches[n],e=this.pi[i.identifier];this.At["Touch"+e]=1,this.At[`Touch${e}X`]=i.clientX,this.At[`Touch${e}Y`]=i.clientY,this.St["Touch"+e]=1,this.St[`Touch${e}X`]=0,this.St[`Touch${e}Y`]=0}})),this.wi.addEventListener("touchmove",(t=>{t.target===this.wi&&t.preventDefault();for(let n=0;n<t.changedTouches.length;n++){let i=t.changedTouches[n],e=this.pi[i.identifier];this.St[`Touch${e}X`]=i.clientX-this.At[`Touch${e}X`],this.St[`Touch${e}Y`]=i.clientY-this.At[`Touch${e}Y`],this.At[`Touch${e}X`]=i.clientX,this.At[`Touch${e}Y`]=i.clientY}})),this.wi.addEventListener("touchend",(t=>{t.target===this.wi&&t.preventDefault();for(let n=0;n<t.changedTouches.length;n++){let i=this.pi[t.changedTouches[n].identifier];this.At["Touch"+i]=0,this.St["Touch"+i]=-1}})),this.wi.addEventListener("touchcancel",(t=>{for(let n=0;n<t.changedTouches.length;n++){let i=this.pi[t.changedTouches[n].identifier];this.At["Touch"+i]=0,this.St["Touch"+i]=-1}})),window.addEventListener("keydown",(t=>{t.repeat||(this.At[t.code]=1,this.St[t.code]=1)})),window.addEventListener("keyup",(t=>{this.At[t.code]=0,this.St[t.code]=-1}))}bi(){let t=0,n=performance.now(),i=e=>{let o=(e-n)/1e3;for(n=e,this.mi=requestAnimationFrame(i),this.Ai(o),t+=o;t>=sn;)t-=sn,this.ki(sn);this.Ci(o),this.Ei(o)};this.yi(),i(n)}yi(){cancelAnimationFrame(this.mi),this.mi=0}Ai(t){this._i=performance.now();let n=Math.abs(this.St.MouseX)+Math.abs(this.St.MouseY);this.gi.Mouse+=n,1===this.At.Mouse0&&(this.gi.Mouse0+=n),1===this.At.Mouse1&&(this.gi.Mouse1+=n),1===this.At.Mouse2&&(this.gi.Mouse2+=n),1===this.At.Touch0&&(this.gi.Touch0+=Math.abs(this.St.Touch0X)+Math.abs(this.St.Touch0Y)),1===this.At.Touch1&&(this.gi.Touch1+=Math.abs(this.St.Touch1X)+Math.abs(this.St.Touch1Y))}ki(t){}Ci(t){}Ei(t){this.Mi=!1,-1===this.St.Mouse0&&(this.gi.Mouse0=0),-1===this.St.Mouse1&&(this.gi.Mouse1=0),-1===this.St.Mouse2&&(this.gi.Mouse2=0),-1===this.St.Touch0&&(this.gi.Touch0=0),-1===this.St.Touch1&&(this.gi.Touch1=0);for(let t in this.St)this.St[t]=0;let n=performance.now()-this._i;on&&(on.textContent=n.toFixed(1)),rn&&(rn.textContent=(1e3*t).toFixed(1)),ln&&(ln.textContent=(1/t).toFixed())}}{constructor(){super(),this.xi=document.querySelector("#billboard"),this.Yt=this.xi.getContext("2d"),this.Fi=document.querySelector("#scene"),this.yn=this.Fi.getContext("webgl2"),this.Audio=new AudioContext,this.Di=[],this.En={},this.yn.enable(2929),this.yn.enable(2884),this.yn.blendFunc(770,771)}Ai(t){super.Ai(t),this.Di=[]}}{constructor(){super(...arguments),this.i=new cn,this.Ti=function(t,n=4){let i=r(t,"#version 300 es\n\nuniform mat4 pv;\nuniform mat4 world;\n\nlayout(location=0) in vec4 attr_position;\n\nvoid main() {\ngl_Position = pv * world * attr_position;\n}\n","#version 300 es\n\nprecision mediump float;\n\nuniform vec4 color;\n\nout vec4 frag_color;\n\nvoid main() {\nfrag_color = color;\n}\n");return{Tn:n,bn:i,An:{W:t.getUniformLocation(i,"pv"),i:t.getUniformLocation(i,"world"),jt:t.getUniformLocation(i,"color")}}}(this.yn,2),this.si=function(t){let n=r(t,"#version 300 es\n\nuniform mat4 pv;\nuniform mat4 world;\nuniform mat4 self;\n\nlayout(location=0) in vec4 attr_position;\nlayout(location=1) in vec3 attr_normal;\n\nout vec4 vert_position;\nout vec3 vert_normal;\n\nvoid main() {\nvert_position = world * attr_position;\nvert_normal = (vec4(attr_normal, 0.0) * self).xyz;\ngl_Position = pv * vert_position;\n}\n","#version 300 es\n\nprecision mediump float;\n\nuniform vec3 eye;\nuniform vec4 diffuse_color;\nuniform vec4 specular_color;\nuniform vec4 emissive_color;\nuniform vec4 light_positions[8];\nuniform vec4 light_details[8];\n\nin vec4 vert_position;\nin vec3 vert_normal;\n\nout vec4 frag_color;\n\n\n\n\n\n\nvec3 GAMMA_DECODE(vec3 rgb) {\nreturn pow(rgb, vec3(2.2));\n}\n\n\nvec4 GAMMA_DECODE(vec4 color) {\nreturn vec4(pow(color.rgb, vec3(2.2)), color.a);\n}\n\n\n\n\n\n\nvec3 GAMMA_ENCODE(vec3 rgb) {\nreturn pow(rgb, vec3(1.0 / 2.2));\n}\n\n\nvec4 GAMMA_ENCODE(vec4 color) {\nreturn vec4(pow(color.rgb, vec3(1.0 / 2.2)), color.a);\n}\n\n\nvoid main() {\nvec3 world_normal = normalize(vert_normal);\n\nvec3 view_dir = eye - vert_position.xyz;\nvec3 view_normal = normalize(view_dir);\n\n\nvec3 light_acc = GAMMA_DECODE(diffuse_color.rgb) * 0.1;\n\nfor (int i = 0; i < 8; i++) {\nint light_kind = int(light_positions[i].w);\nif (light_kind == 0) {\nbreak;\n}\n\nvec3 light_rgb = GAMMA_DECODE(light_details[i].rgb);\nfloat light_intensity = light_details[i].a;\n\nvec3 light_normal;\nif (light_kind == 2) {\nlight_normal = light_positions[i].xyz;\n} else if (light_kind == 3) {\nvec3 light_dir = light_positions[i].xyz - vert_position.xyz;\nfloat light_dist = length(light_dir);\nlight_normal = light_dir / light_dist;\n\nlight_intensity /= (light_dist * light_dist);\n}\n\nfloat diffuse_factor = dot(world_normal, light_normal);\nif (diffuse_factor > 0.0) {\n\nlight_acc += GAMMA_DECODE(diffuse_color.rgb) * diffuse_factor * light_rgb * light_intensity;\n\nif (specular_color.a > 0.0) {\n\n\n\n\n\n\nvec3 h = normalize(light_normal + view_normal);\nfloat specular_angle = max(dot(h, world_normal), 0.0);\nfloat specular_factor = pow(specular_angle, specular_color.a);\n\n\nlight_acc += GAMMA_DECODE(specular_color.rgb) * specular_factor * light_rgb * light_intensity;\n}\n}\n}\n\nvec3 emissive_rgb = GAMMA_DECODE(emissive_color.rgb) * emissive_color.a;\nfrag_color = vec4(GAMMA_ENCODE(light_acc + emissive_rgb), diffuse_color.a);\n}\n");return{Tn:4,bn:n,An:{W:t.getUniformLocation(n,"pv"),i:t.getUniformLocation(n,"world"),it:t.getUniformLocation(n,"self"),Kt:t.getUniformLocation(n,"diffuse_color"),Gt:t.getUniformLocation(n,"specular_color"),Nt:t.getUniformLocation(n,"emissive_color"),kn:t.getUniformLocation(n,"eye"),Ht:t.getUniformLocation(n,"light_positions"),Jt:t.getUniformLocation(n,"light_details")}}}(this.yn),this.ai=function(t){let n=r(t,"#version 300 es\n\nuniform mat4 pv;\nuniform vec4 color_start;\nuniform vec4 color_end;\n\nuniform vec4 details;\n\n\nin vec4 attr_origin_age;\nin vec3 attr_direction;\n\nout vec4 vert_color;\n\nvoid main() {\n\nvec3 velocity = attr_direction * details.y;\ngl_Position = pv * vec4(attr_origin_age.xyz + velocity * attr_origin_age.w, 1.0);\n\n\nfloat t = attr_origin_age.w / details.x;\ngl_PointSize = mix(details.z, details.w, t);\nvert_color = mix(color_start, color_end, t);\n}\n","#version 300 es\n\nprecision mediump float;\n\nin vec4 vert_color;\n\nout vec4 frag_color;\n\nvoid main() {\nfrag_color = vert_color;\n}\n");return{Tn:0,bn:n,An:{W:t.getUniformLocation(n,"pv"),Ln:t.getUniformLocation(n,"color_start"),Kn:t.getUniformLocation(n,"color_end"),Gn:t.getUniformLocation(n,"details"),Yn:t.getAttribLocation(n,"attr_origin_age"),gt:t.getAttribLocation(n,"attr_direction")}}}(this.yn),this.ci=function(t){let n=t.createVertexArray();t.bindVertexArray(n);let i=t.createBuffer();t.bindBuffer(Wt,i),t.bufferData(Wt,an,Ut),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,3,en,!1,0,0);let e=t.createBuffer();t.bindBuffer(Wt,e),t.bufferData(Wt,un,Ut),t.enableVertexAttribArray(1),t.vertexAttribPointer(1,3,en,!1,0,0);let o=t.createBuffer();t.bindBuffer(Wt,o),t.bufferData(Wt,fn,Ut),t.enableVertexAttribArray(2),t.vertexAttribPointer(2,2,en,!1,0,0);let r=t.createBuffer();t.bindBuffer(Wt,r),t.bufferData(Wt,hn,Ut),t.enableVertexAttribArray(5),t.vertexAttribPointer(5,4,en,!1,0,0);let l=t.createBuffer();return t.bindBuffer(34963,l),t.bufferData(34963,dn,Ut),t.bindVertexArray(null),{Dn:n,zn:i,Si:an,Pi:e,$i:un,Oi:o,Ri:fn,Ii:r,zi:hn,Li:l,Ki:dn,Sn:dn.length}}(this.yn),this.Ht=new Float32Array(32),this.Jt=new Float32Array(32),this.h=0,this.v=0}ki(t){!function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&Hn)===Hn&&ot(t,i,n)}(this,t),wt(this),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&Jn)===Jn&&rt(t,i,n)}(this,t),function(t,n){let i=[],e=[];for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&xn)===xn){let o=t.i.m[n],r=t.i.hn[n];r.ft=[],r.ri?(r.ri=!1,G(o.i,r)):r.li?(G(o.i,r),e.push(r)):i.push(r)}for(let t=0;t<e.length;t++)Y(e[t],i,i.length),Y(e[t],e,t)}(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&ti)===ti&&lt(t,n)}(this),wt(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&ai)===ai&&bt(t,n)}(this)}Ci(t){!function(t,n){let i=[];for(let e=0;e<t.i.o.length;e++)if((t.i.o[e]&ii)===ii){if(st(t.i,e))continue;let o=t.i.ui[e];switch(o.L){case 0:o.Gi(e)&&i.push(e);break;case 1:o.Ut-=n,o.Ut<0&&i.push(e)}}for(let n of i){let i=t.i.ui[n];i.fi&&i.fi(n),t.i.o[n]&=-1048577,0===t.i.o[n]&&t.i.u(n),delete t.i.ui[n]}}(this,t),function(t,n){if(t.Pt==window.innerWidth&&t.$t==window.innerHeight||(t.Mi=!0),t.Mi){t.Pt=t.Fi.width=t.xi.width=window.innerWidth,t.$t=t.Fi.height=t.xi.height=window.innerHeight;for(let n of Object.values(t.En))if(n.Ni)switch(n.L){case 0:ut(t.yn,n,t.Pt,t.$t);break;case 1:ft(t.yn,n,t.Pt,t.$t);break;case 2:ht(t.yn,n,t.Pt,t.$t)}for(let n=0;n<t.i.o.length;n++)if(8==(8&t.i.o[n])){let i=t.i.j[n];switch(i.L){case 0:_t(i.V,t.Pt/t.$t);break;case 1:_t(i.V,i.ni.dn/i.ni.vn)}}}}(this),function(t,n){for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&Cn)===Cn){let i=t.i.j[n];switch(i.L){case 0:case 1:K(t,n,i),t.Di.push(n)}}}(this),function(t,n){for(let n=0;n<t.i.o.length;n++)16512==(16512&t.i.o[n])&&j(t,n)}(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&Tn)===Tn&&V(t,n)}(this),function(t,n){1===t.St.Touch0&&(In[0]=t.At.Touch0X,In[1]=t.At.Touch0Y);for(let n=0;n<t.i.o.length;n++)16512==(16512&t.i.o[n])&&U(t,n)}(this),function(t,n){for(let n of navigator.getGamepads())n&&(t.St[`pad${n.index}_axis_1`]=n.axes[0],t.St[`pad${n.index}_axis_2`]=n.axes[1],t.St[`pad${n.index}_axis_3`]=n.axes[2],t.St[`pad${n.index}_axis_4`]=n.axes[3]);for(let n=0;n<t.i.o.length;n++)16512==(16512&t.i.o[n])&&W(t,n)}(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&Dn)===Dn&&B(t,n)}(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&Fn)===Fn&&X(t,n)}(this),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&_n)===_n&&A(t,i,n)}(this,t),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&jn)===jn&&nt(t,i,n)}(this,t),function(t,n){for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&Bn)===Bn){let i=t.i.m[n],e=t.i.ti[n],o=t.i.m[e.ni],r=D([0,0,0],o.i),l=T([0,0,0,0],o.i);_(i.T,i.T,r,e.ii),b(i.S,i.S,l,e.ii),t.i.o[n]|=256}}(this),function(t,n){for(let i=0;i<t.i.o.length;i++)2048==(2048&t.i.o[i])&&Z(t,i,n)}(this,t),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&oi)==oi&&Mt(t,n)}(this),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&li)==li&&pt(t,i,n)}(this,t),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&ri)==ri&&gt(t,i,n)}(this,t),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&Un)==Un&&it(t,i,n)}(this,t),wt(this),function(t,n){for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&Mn)===Mn&&P(t,n)}(this),function(t,n){for(let i=0;i<t.i.o.length;i++)(t.i.o[i]&bn)===bn&&I(t,i,n)}(this,t),function(t,n){t.Ht.fill(0),t.Jt.fill(0);let i=0;for(let n=0;n<t.i.o.length;n++)(t.i.o[n]&Yn)===Yn&&tt(t,n,i++)}(this),function(t,n){for(let n of t.Di){let i=t.i.j[n];switch(i.L){case 0:t.yn.bindFramebuffer(36160,null),t.yn.viewport(0,0,t.Pt,t.$t),t.yn.clearColor(...i.tt),t.yn.clear(i.nt),dt(t,i);break;case 1:0===i.ni.L&&(t.yn.bindFramebuffer(36160,i.ni.Yi),t.yn.viewport(0,0,i.ni.dn,i.ni.vn),t.yn.clearColor(...i.tt),t.yn.clear(i.nt),dt(t,i,i.ni.mn))}}}(this),function(t,n){t.Yt.resetTransform(),t.Yt.clearRect(0,0,t.Pt,t.$t);let i=[0,0,0],e=t.i.j[t.Di[0]];if(e&&2!==e.L)for(let n=0;n<t.i.o.length;n++)if((t.i.o[n]&Nn)==Nn){if(D(i,t.i.m[n].i),v(i,i,e.W),i[2]<-1||i[2]>1)continue;t.Yt.setTransform(1,0,0,1,.5*(i[0]+1)*t.Pt,.5*(1-i[1])*t.$t);let o=t.i.vi[n];switch(o.L){case 0:J(t,o);break;case 2:Q(t,o)}}}(this),function(t,n){let i=function(t){return At`<div>${At`
<div
style="
position: absolute;
top: 1vmin;
left: 1vmin;
background: #000;
color: #fff;
font: 13px Arial;
"
>
<button
onclick="$(${0})"
style="
padding: 1vmin;
background: #000;
color: #fff;
border: none;
"
>
${document.fullscreenElement?"Exit Fullscreen":"Enter Fullscreen"}
</button>
</div>
`} ${function(t){return At`
<div
style="
position: absolute;
right: 0;
bottom: 0;
left: 0;
height: 10vmin;

display: flex;
justify-content: space-around;
align-items: center;

background: rgba(0, 0, 0, 0.5);
color: #fff;
font: 24px Impact;
font-style: italic;
"
>
<div>Collected: ${t.h}</div>
<div>Missed: ${t.v}</div>
</div>
`}(t)}</div>`}(t);i!==jt&&(t.wi.innerHTML=jt=i)}(this)}};(Vt=ui).wi.addEventListener("click",(()=>Vt.wi.requestPointerLock())),function(i){i.i=new cn,i.Mi=!0;for(let n=0;n<10;n++)for(let e=0;e<10;e++)t(i,[...Ft(i),H([5*(e-5),0,5*(n-5)],void 0,[5,1,5])]);var e;t(i,[H(void 0,p([0,0,0,1],-30,30,0)),$t([1,1,1],.1)]),t(i,[...Xt(i),H([0,1,0],[0,1,0,0])]),t(i,[...Et(i),H([0,1e3,1e3],[0,1,0,0])]),t(i,[H([0,15,0]),St(null,[0,1,0,0]),Rt(0,1),n([H([0,0,10]),n([H(),It(10),(e=zt,(t,n)=>{t.i.o[n]|=524288,t.i.qn[n]={Jn:e,Hn:3,on:3}})])])]);for(let n=0;n<100;n++)t(i,[H([$(-10,10),1,$(-10,10)],void 0,[$(.5,1.5),$(.5,1.5),$(.5,1.5)]),...Lt(i)])}(ui),ui.bi(),window.$=o.bind(null,ui),window.game=ui})();
